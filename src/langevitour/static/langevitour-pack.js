var langevitour;(()=>{var t={162:function(t){var e;t.exports=(e=function(t,e){var n=Array.prototype.concat,r=Array.prototype.slice,i=Object.prototype.toString;function a(e,n){var r=e>n?e:n;return t.pow(10,17-~~(t.log(r>0?r:-r)*t.LOG10E))}var o=Array.isArray||function(t){return"[object Array]"===i.call(t)};function s(t){return"[object Function]"===i.call(t)}function u(t){return"number"==typeof t&&t-t==0}function l(){return new l._init(arguments)}function c(){return 0}function f(){return 1}function h(t,e){return t===e?1:0}l.fn=l.prototype,l._init=function(t){if(o(t[0]))if(o(t[0][0])){s(t[1])&&(t[0]=l.map(t[0],t[1]));for(var e=0;e<t[0].length;e++)this[e]=t[0][e];this.length=t[0].length}else this[0]=s(t[1])?l.map(t[0],t[1]):t[0],this.length=1;else if(u(t[0]))this[0]=l.seq.apply(null,t),this.length=1;else{if(t[0]instanceof l)return l(t[0].toArray());this[0]=[],this.length=1}return this},l._init.prototype=l.prototype,l._init.constructor=l,l.utils={calcRdx:a,isArray:o,isFunction:s,isNumber:u,toVector:function(t){return n.apply([],t)}},l._random_fn=t.random,l.setRandom=function(t){if("function"!=typeof t)throw new TypeError("fn is not a function");l._random_fn=t},l.extend=function(t){var e,n;if(1===arguments.length){for(n in t)l[n]=t[n];return this}for(e=1;e<arguments.length;e++)for(n in arguments[e])t[n]=arguments[e][n];return t},l.rows=function(t){return t.length||1},l.cols=function(t){return t[0].length||1},l.dimensions=function(t){return{rows:l.rows(t),cols:l.cols(t)}},l.row=function(t,e){return o(e)?e.map((function(e){return l.row(t,e)})):t[e]},l.rowa=function(t,e){return l.row(t,e)},l.col=function(t,e){if(o(e)){var n=l.arange(t.length).map((function(){return new Array(e.length)}));return e.forEach((function(e,r){l.arange(t.length).forEach((function(i){n[i][r]=t[i][e]}))})),n}for(var r=new Array(t.length),i=0;i<t.length;i++)r[i]=[t[i][e]];return r},l.cola=function(t,e){return l.col(t,e).map((function(t){return t[0]}))},l.diag=function(t){for(var e=l.rows(t),n=new Array(e),r=0;r<e;r++)n[r]=[t[r][r]];return n},l.antidiag=function(t){for(var e=l.rows(t)-1,n=new Array(e),r=0;e>=0;e--,r++)n[r]=[t[r][e]];return n},l.transpose=function(t){var e,n,r,i,a,s=[];for(o(t[0])||(t=[t]),n=t.length,r=t[0].length,a=0;a<r;a++){for(e=new Array(n),i=0;i<n;i++)e[i]=t[i][a];s.push(e)}return 1===s.length?s[0]:s},l.map=function(t,e,n){var r,i,a,s,u;for(o(t[0])||(t=[t]),i=t.length,a=t[0].length,s=n?t:new Array(i),r=0;r<i;r++)for(s[r]||(s[r]=new Array(a)),u=0;u<a;u++)s[r][u]=e(t[r][u],r,u);return 1===s.length?s[0]:s},l.cumreduce=function(t,e,n){var r,i,a,s,u;for(o(t[0])||(t=[t]),i=t.length,a=t[0].length,s=n?t:new Array(i),r=0;r<i;r++)for(s[r]||(s[r]=new Array(a)),a>0&&(s[r][0]=t[r][0]),u=1;u<a;u++)s[r][u]=e(s[r][u-1],t[r][u]);return 1===s.length?s[0]:s},l.alter=function(t,e){return l.map(t,e,!0)},l.create=function(t,e,n){var r,i,a=new Array(t);for(s(e)&&(n=e,e=t),r=0;r<t;r++)for(a[r]=new Array(e),i=0;i<e;i++)a[r][i]=n(r,i);return a},l.zeros=function(t,e){return u(e)||(e=t),l.create(t,e,c)},l.ones=function(t,e){return u(e)||(e=t),l.create(t,e,f)},l.rand=function(t,e){return u(e)||(e=t),l.create(t,e,l._random_fn)},l.identity=function(t,e){return u(e)||(e=t),l.create(t,e,h)},l.symmetric=function(t){var e,n,r=t.length;if(t.length!==t[0].length)return!1;for(e=0;e<r;e++)for(n=0;n<r;n++)if(t[n][e]!==t[e][n])return!1;return!0},l.clear=function(t){return l.alter(t,c)},l.seq=function(t,e,n,r){s(r)||(r=!1);var i,o=[],u=a(t,e),l=(e*u-t*u)/((n-1)*u),c=t;for(i=0;c<=e&&i<n;c=(t*u+l*u*++i)/u)o.push(r?r(c,i):c);return o},l.arange=function(t,n,r){var i,a=[];if(r=r||1,n===e&&(n=t,t=0),t===n||0===r)return[];if(t<n&&r<0)return[];if(t>n&&r>0)return[];if(r>0)for(i=t;i<n;i+=r)a.push(i);else for(i=t;i>n;i+=r)a.push(i);return a},l.slice=function(){function t(t,n,r,i){var a,o=[],s=t.length;if(n===e&&r===e&&i===e)return l.copy(t);if(i=i||1,(n=(n=n||0)>=0?n:s+n)===(r=(r=r||t.length)>=0?r:s+r)||0===i)return[];if(n<r&&i<0)return[];if(n>r&&i>0)return[];if(i>0)for(a=n;a<r;a+=i)o.push(t[a]);else for(a=n;a>r;a+=i)o.push(t[a]);return o}return function(e,n){var r,i;return u((n=n||{}).row)?u(n.col)?e[n.row][n.col]:t(l.rowa(e,n.row),(r=n.col||{}).start,r.end,r.step):u(n.col)?t(l.cola(e,n.col),(i=n.row||{}).start,i.end,i.step):(i=n.row||{},r=n.col||{},t(e,i.start,i.end,i.step).map((function(e){return t(e,r.start,r.end,r.step)})))}}(),l.sliceAssign=function(n,r,i){var a,o;if(u(r.row)){if(u(r.col))return n[r.row][r.col]=i;r.col=r.col||{},r.col.start=r.col.start||0,r.col.end=r.col.end||n[0].length,r.col.step=r.col.step||1,a=l.arange(r.col.start,t.min(n.length,r.col.end),r.col.step);var s=r.row;return a.forEach((function(t,e){n[s][t]=i[e]})),n}if(u(r.col)){r.row=r.row||{},r.row.start=r.row.start||0,r.row.end=r.row.end||n.length,r.row.step=r.row.step||1,o=l.arange(r.row.start,t.min(n[0].length,r.row.end),r.row.step);var c=r.col;return o.forEach((function(t,e){n[t][c]=i[e]})),n}return i[0].length===e&&(i=[i]),r.row.start=r.row.start||0,r.row.end=r.row.end||n.length,r.row.step=r.row.step||1,r.col.start=r.col.start||0,r.col.end=r.col.end||n[0].length,r.col.step=r.col.step||1,o=l.arange(r.row.start,t.min(n.length,r.row.end),r.row.step),a=l.arange(r.col.start,t.min(n[0].length,r.col.end),r.col.step),o.forEach((function(t,e){a.forEach((function(r,a){n[t][r]=i[e][a]}))})),n},l.diagonal=function(t){var e=l.zeros(t.length,t.length);return t.forEach((function(t,n){e[n][n]=t})),e},l.copy=function(t){return t.map((function(t){return u(t)?t:t.map((function(t){return t}))}))};var d=l.prototype;return d.length=0,d.push=Array.prototype.push,d.sort=Array.prototype.sort,d.splice=Array.prototype.splice,d.slice=Array.prototype.slice,d.toArray=function(){return this.length>1?r.call(this):r.call(this)[0]},d.map=function(t,e){return l(l.map(this,t,e))},d.cumreduce=function(t,e){return l(l.cumreduce(this,t,e))},d.alter=function(t){return l.alter(this,t),this},function(t){for(var e=0;e<t.length;e++)!function(t){d[t]=function(e){var n,r=this;return e?(setTimeout((function(){e.call(r,d[t].call(r))})),this):(n=l[t](this),o(n)?l(n):n)}}(t[e])}("transpose clear symmetric rows cols dimensions diag antidiag".split(" ")),function(t){for(var e=0;e<t.length;e++)!function(t){d[t]=function(e,n){var r=this;return n?(setTimeout((function(){n.call(r,d[t].call(r,e))})),this):l(l[t](this,e))}}(t[e])}("row col".split(" ")),function(t){for(var e=0;e<t.length;e++)!function(t){d[t]=function(){return l(l[t].apply(null,arguments))}}(t[e])}("create zeros ones rand identity".split(" ")),l}(Math),function(t,e){var n=t.utils.isFunction;function r(t,e){return t-e}function i(t,n,r){return e.max(n,e.min(t,r))}t.sum=function(t){for(var e=0,n=t.length;--n>=0;)e+=t[n];return e},t.sumsqrd=function(t){for(var e=0,n=t.length;--n>=0;)e+=t[n]*t[n];return e},t.sumsqerr=function(e){for(var n,r=t.mean(e),i=0,a=e.length;--a>=0;)i+=(n=e[a]-r)*n;return i},t.sumrow=function(t){for(var e=0,n=t.length;--n>=0;)e+=t[n];return e},t.product=function(t){for(var e=1,n=t.length;--n>=0;)e*=t[n];return e},t.min=function(t){for(var e=t[0],n=0;++n<t.length;)t[n]<e&&(e=t[n]);return e},t.max=function(t){for(var e=t[0],n=0;++n<t.length;)t[n]>e&&(e=t[n]);return e},t.unique=function(t){for(var e={},n=[],r=0;r<t.length;r++)e[t[r]]||(e[t[r]]=!0,n.push(t[r]));return n},t.mean=function(e){return t.sum(e)/e.length},t.meansqerr=function(e){return t.sumsqerr(e)/e.length},t.geomean=function(n){return e.pow(t.product(n),1/n.length)},t.median=function(t){var e=t.length,n=t.slice().sort(r);return 1&e?n[e/2|0]:(n[e/2-1]+n[e/2])/2},t.cumsum=function(e){return t.cumreduce(e,(function(t,e){return t+e}))},t.cumprod=function(e){return t.cumreduce(e,(function(t,e){return t*e}))},t.diff=function(t){var e,n=[],r=t.length;for(e=1;e<r;e++)n.push(t[e]-t[e-1]);return n},t.rank=function(t){var e,n=[],i={};for(e=0;e<t.length;e++)i[u=t[e]]?i[u]++:(i[u]=1,n.push(u));var a=n.sort(r),o={},s=1;for(e=0;e<a.length;e++){var u,l=i[u=a[e]],c=(s+(s+l-1))/2;o[u]=c,s+=l}return t.map((function(t){return o[t]}))},t.mode=function(t){var e,n=t.length,i=t.slice().sort(r),a=1,o=0,s=0,u=[];for(e=0;e<n;e++)i[e]===i[e+1]?a++:(a>o?(u=[i[e]],o=a,s=0):a===o&&(u.push(i[e]),s++),a=1);return 0===s?u[0]:u},t.range=function(e){return t.max(e)-t.min(e)},t.variance=function(e,n){return t.sumsqerr(e)/(e.length-(n?1:0))},t.pooledvariance=function(e){return e.reduce((function(e,n){return e+t.sumsqerr(n)}),0)/(e.reduce((function(t,e){return t+e.length}),0)-e.length)},t.deviation=function(e){for(var n=t.mean(e),r=e.length,i=new Array(r),a=0;a<r;a++)i[a]=e[a]-n;return i},t.stdev=function(n,r){return e.sqrt(t.variance(n,r))},t.pooledstdev=function(n){return e.sqrt(t.pooledvariance(n))},t.meandev=function(n){for(var r=t.mean(n),i=[],a=n.length-1;a>=0;a--)i.push(e.abs(n[a]-r));return t.mean(i)},t.meddev=function(n){for(var r=t.median(n),i=[],a=n.length-1;a>=0;a--)i.push(e.abs(n[a]-r));return t.median(i)},t.coeffvar=function(e){return t.stdev(e)/t.mean(e)},t.quartiles=function(t){var n=t.length,i=t.slice().sort(r);return[i[e.round(n/4)-1],i[e.round(n/2)-1],i[e.round(3*n/4)-1]]},t.quantiles=function(t,n,a,o){var s,u,l,c,f,h=t.slice().sort(r),d=[n.length],p=t.length;for(void 0===a&&(a=3/8),void 0===o&&(o=3/8),s=0;s<n.length;s++)l=p*(u=n[s])+(a+u*(1-a-o)),c=e.floor(i(l,1,p-1)),f=i(l-c,0,1),d[s]=(1-f)*h[c-1]+f*h[c];return d},t.percentile=function(t,e,n){var i=t.slice().sort(r),a=e*(i.length+(n?1:-1))+(n?0:1),o=parseInt(a),s=a-o;return o+1<i.length?i[o-1]+s*(i[o]-i[o-1]):i[o-1]},t.percentileOfScore=function(t,e,n){var r,i,a=0,o=t.length,s=!1;for("strict"===n&&(s=!0),i=0;i<o;i++)r=t[i],(s&&r<e||!s&&r<=e)&&a++;return a/o},t.histogram=function(n,r){r=r||4;var i,a=t.min(n),o=(t.max(n)-a)/r,s=n.length,u=[];for(i=0;i<r;i++)u[i]=0;for(i=0;i<s;i++)u[e.min(e.floor((n[i]-a)/o),r-1)]+=1;return u},t.covariance=function(e,n){var r,i=t.mean(e),a=t.mean(n),o=e.length,s=new Array(o);for(r=0;r<o;r++)s[r]=(e[r]-i)*(n[r]-a);return t.sum(s)/(o-1)},t.corrcoeff=function(e,n){return t.covariance(e,n)/t.stdev(e,1)/t.stdev(n,1)},t.spearmancoeff=function(e,n){return e=t.rank(e),n=t.rank(n),t.corrcoeff(e,n)},t.stanMoment=function(n,r){for(var i=t.mean(n),a=t.stdev(n),o=n.length,s=0,u=0;u<o;u++)s+=e.pow((n[u]-i)/a,r);return s/n.length},t.skewness=function(e){return t.stanMoment(e,3)},t.kurtosis=function(e){return t.stanMoment(e,4)-3};var a=t.prototype;!function(e){for(var r=0;r<e.length;r++)!function(e){a[e]=function(r,i){var o=[],s=0,u=this;if(n(r)&&(i=r,r=!1),i)return setTimeout((function(){i.call(u,a[e].call(u,r))})),this;if(this.length>1){for(u=!0===r?this:this.transpose();s<u.length;s++)o[s]=t[e](u[s]);return o}return t[e](this[0],r)}}(e[r])}("cumsum cumprod".split(" ")),function(e){for(var r=0;r<e.length;r++)!function(e){a[e]=function(r,i){var o=[],s=0,u=this;if(n(r)&&(i=r,r=!1),i)return setTimeout((function(){i.call(u,a[e].call(u,r))})),this;if(this.length>1){for("sumrow"!==e&&(u=!0===r?this:this.transpose());s<u.length;s++)o[s]=t[e](u[s]);return!0===r?t[e](t.utils.toVector(o)):o}return t[e](this[0],r)}}(e[r])}("sum sumsqrd sumsqerr sumrow product min max unique mean meansqerr geomean median diff rank mode range variance deviation stdev meandev meddev coeffvar quartiles histogram skewness kurtosis".split(" ")),function(e){for(var r=0;r<e.length;r++)!function(e){a[e]=function(){var r,i=[],o=0,s=this,u=Array.prototype.slice.call(arguments);if(n(u[u.length-1])){r=u[u.length-1];var l=u.slice(0,u.length-1);return setTimeout((function(){r.call(s,a[e].apply(s,l))})),this}r=void 0;var c=function(n){return t[e].apply(s,[n].concat(u))};if(this.length>1){for(s=s.transpose();o<s.length;o++)i[o]=c(s[o]);return i}return c(this[0])}}(e[r])}("quantiles percentileOfScore".split(" "))}(e,Math),function(t,e){t.gammaln=function(t){var n,r,i,a=0,o=[76.18009172947146,-86.50532032941678,24.01409824083091,-1.231739572450155,.001208650973866179,-5395239384953e-18],s=1.000000000190015;for(i=(r=n=t)+5.5,i-=(n+.5)*e.log(i);a<6;a++)s+=o[a]/++r;return e.log(2.5066282746310007*s/n)-i},t.loggam=function(t){var n,r,i,a,o,s,u,l=[.08333333333333333,-.002777777777777778,.0007936507936507937,-.0005952380952380952,.0008417508417508418,-.001917526917526918,.00641025641025641,-.02955065359477124,.1796443723688307,-1.3924322169059];if(n=t,u=0,1==t||2==t)return 0;for(t<=7&&(n=t+(u=e.floor(7-t))),r=1/(n*n),i=2*e.PI,o=l[9],s=8;s>=0;s--)o*=r,o+=l[s];if(a=o/n+.5*e.log(i)+(n-.5)*e.log(n)-n,t<=7)for(s=1;s<=u;s++)a-=e.log(n-1),n-=1;return a},t.gammafn=function(t){var n,r,i,a,o=[-1.716185138865495,24.76565080557592,-379.80425647094563,629.3311553128184,866.9662027904133,-31451.272968848367,-36144.413418691176,66456.14382024054],s=[-30.8402300119739,315.35062697960416,-1015.1563674902192,-3107.771671572311,22538.11842098015,4755.846277527881,-134659.9598649693,-115132.2596755535],u=!1,l=0,c=0,f=0,h=t;if(t>171.6243769536076)return 1/0;if(h<=0){if(!(a=h%1+36e-17))return 1/0;u=(1&h?-1:1)*e.PI/e.sin(e.PI*a),h=1-h}for(i=h,r=h<1?h++:(h-=l=(0|h)-1)-1,n=0;n<8;++n)f=(f+o[n])*r,c=c*r+s[n];if(a=f/c+1,i<h)a/=i;else if(i>h)for(n=0;n<l;++n)a*=h,h++;return u&&(a=u/a),a},t.gammap=function(e,n){return t.lowRegGamma(e,n)*t.gammafn(e)},t.lowRegGamma=function(n,r){var i,a=t.gammaln(n),o=n,s=1/n,u=s,l=r+1-n,c=1/1e-30,f=1/l,h=f,d=1,p=-~(8.5*e.log(n>=1?n:1/n)+.4*n+17);if(r<0||n<=0)return NaN;if(r<n+1){for(;d<=p;d++)s+=u*=r/++o;return s*e.exp(-r+n*e.log(r)-a)}for(;d<=p;d++)h*=(f=1/(f=(i=-d*(d-n))*f+(l+=2)))*(c=l+i/c);return 1-h*e.exp(-r+n*e.log(r)-a)},t.factorialln=function(e){return e<0?NaN:t.gammaln(e+1)},t.factorial=function(e){return e<0?NaN:t.gammafn(e+1)},t.combination=function(n,r){return n>170||r>170?e.exp(t.combinationln(n,r)):t.factorial(n)/t.factorial(r)/t.factorial(n-r)},t.combinationln=function(e,n){return t.factorialln(e)-t.factorialln(n)-t.factorialln(e-n)},t.permutation=function(e,n){return t.factorial(e)/t.factorial(e-n)},t.betafn=function(n,r){if(!(n<=0||r<=0))return n+r>170?e.exp(t.betaln(n,r)):t.gammafn(n)*t.gammafn(r)/t.gammafn(n+r)},t.betaln=function(e,n){return t.gammaln(e)+t.gammaln(n)-t.gammaln(e+n)},t.betacf=function(t,n,r){var i,a,o,s,u=1e-30,l=1,c=n+r,f=n+1,h=n-1,d=1,p=1-c*t/f;for(e.abs(p)<u&&(p=u),s=p=1/p;l<=100&&(p=1+(a=l*(r-l)*t/((h+(i=2*l))*(n+i)))*p,e.abs(p)<u&&(p=u),d=1+a/d,e.abs(d)<u&&(d=u),s*=(p=1/p)*d,p=1+(a=-(n+l)*(c+l)*t/((n+i)*(f+i)))*p,e.abs(p)<u&&(p=u),d=1+a/d,e.abs(d)<u&&(d=u),s*=o=(p=1/p)*d,!(e.abs(o-1)<3e-7));l++);return s},t.gammapinv=function(n,r){var i,a,o,s,u,l,c=0,f=r-1,h=t.gammaln(r);if(n>=1)return e.max(100,r+100*e.sqrt(r));if(n<=0)return 0;for(r>1?(u=e.log(f),l=e.exp(f*(u-1)-h),s=n<.5?n:1-n,i=(2.30753+.27061*(a=e.sqrt(-2*e.log(s))))/(1+a*(.99229+.04481*a))-a,n<.5&&(i=-i),i=e.max(.001,r*e.pow(1-1/(9*r)-i/(3*e.sqrt(r)),3))):i=n<(a=1-r*(.253+.12*r))?e.pow(n/a,1/r):1-e.log(1-(n-a)/(1-a));c<12;c++){if(i<=0)return 0;if((i-=a=(o=(t.lowRegGamma(r,i)-n)/(a=r>1?l*e.exp(-(i-f)+f*(e.log(i)-u)):e.exp(-i+f*e.log(i)-h)))/(1-.5*e.min(1,o*((r-1)/i-1))))<=0&&(i=.5*(i+a)),e.abs(a)<1e-8*i)break}return i},t.erf=function(t){var n,r,i,a,o=[-1.3026537197817094,.6419697923564902,.019476473204185836,-.00956151478680863,-.000946595344482036,.000366839497852761,42523324806907e-18,-20278578112534e-18,-1624290004647e-18,130365583558e-17,1.5626441722e-8,-8.5238095915e-8,6.529054439e-9,5.059343495e-9,-9.91364156e-10,-2.27365122e-10,96467911e-18,2394038e-18,-6886027e-18,894487e-18,313092e-18,-112708e-18,381e-18,7106e-18,-1523e-18,-94e-18,121e-18,-28e-18],s=o.length-1,u=!1,l=0,c=0;for(t<0&&(t=-t,u=!0),r=4*(n=2/(2+t))-2;s>0;s--)i=l,l=r*l-c+o[s],c=i;return a=n*e.exp(-t*t+.5*(o[0]+r*l)-c),u?a-1:1-a},t.erfc=function(e){return 1-t.erf(e)},t.erfcinv=function(n){var r,i,a,o,s=0;if(n>=2)return-100;if(n<=0)return 100;for(o=n<1?n:2-n,r=-.70711*((2.30753+.27061*(a=e.sqrt(-2*e.log(o/2))))/(1+a*(.99229+.04481*a))-a);s<2;s++)r+=(i=t.erfc(r)-o)/(1.1283791670955126*e.exp(-r*r)-r*i);return n<1?r:-r},t.ibetainv=function(n,r,i){var a,o,s,u,l,c,f,h,d,p,g=r-1,m=i-1,v=0;if(n<=0)return 0;if(n>=1)return 1;for(r>=1&&i>=1?(s=n<.5?n:1-n,c=(2.30753+.27061*(u=e.sqrt(-2*e.log(s))))/(1+u*(.99229+.04481*u))-u,n<.5&&(c=-c),f=(c*c-3)/6,h=2/(1/(2*r-1)+1/(2*i-1)),d=c*e.sqrt(f+h)/h-(1/(2*i-1)-1/(2*r-1))*(f+5/6-2/(3*h)),c=r/(r+i*e.exp(2*d))):(a=e.log(r/(r+i)),o=e.log(i/(r+i)),c=n<(u=e.exp(r*a)/r)/(d=u+(l=e.exp(i*o)/i))?e.pow(r*d*n,1/r):1-e.pow(i*d*(1-n),1/i)),p=-t.gammaln(r)-t.gammaln(i)+t.gammaln(r+i);v<10;v++){if(0===c||1===c)return c;if((c-=u=(l=(t.ibeta(c,r,i)-n)/(u=e.exp(g*e.log(c)+m*e.log(1-c)+p)))/(1-.5*e.min(1,l*(g/c-m/(1-c)))))<=0&&(c=.5*(c+u)),c>=1&&(c=.5*(c+u+1)),e.abs(u)<1e-8*c&&v>0)break}return c},t.ibeta=function(n,r,i){var a=0===n||1===n?0:e.exp(t.gammaln(r+i)-t.gammaln(r)-t.gammaln(i)+r*e.log(n)+i*e.log(1-n));return!(n<0||n>1)&&(n<(r+1)/(r+i+2)?a*t.betacf(n,r,i)/r:1-a*t.betacf(1-n,i,r)/i)},t.randn=function(n,r){var i,a,o,s,u;if(r||(r=n),n)return t.create(n,r,(function(){return t.randn()}));do{i=t._random_fn(),a=1.7156*(t._random_fn()-.5),u=(o=i-.449871)*o+(s=e.abs(a)+.386595)*(.196*s-.25472*o)}while(u>.27597&&(u>.27846||a*a>-4*e.log(i)*i*i));return a/i},t.randg=function(n,r,i){var a,o,s,u,l,c,f=n;if(i||(i=r),n||(n=1),r)return(c=t.zeros(r,i)).alter((function(){return t.randg(n)})),c;n<1&&(n+=1),a=n-1/3,o=1/e.sqrt(9*a);do{do{u=1+o*(l=t.randn())}while(u<=0);u*=u*u,s=t._random_fn()}while(s>1-.331*e.pow(l,4)&&e.log(s)>.5*l*l+a*(1-u+e.log(u)));if(n==f)return a*u;do{s=t._random_fn()}while(0===s);return e.pow(s,1/f)*a*u},function(e){for(var n=0;n<e.length;n++)!function(e){t.fn[e]=function(){return t(t.map(this,(function(n){return t[e](n)})))}}(e[n])}("gammaln gammafn factorial factorialln".split(" ")),function(e){for(var n=0;n<e.length;n++)!function(e){t.fn[e]=function(){return t(t[e].apply(null,arguments))}}(e[n])}("randn".split(" "))}(e,Math),function(t,e){function n(t,n,r,i){for(var a,o=0,s=1,u=1,l=1,c=0,f=0;e.abs((u-f)/u)>i;)f=u,s=l+(a=-(n+c)*(n+r+c)*t/(n+2*c)/(n+2*c+1))*s,u=(o=u+a*o)+(a=(c+=1)*(r-c)*t/(n+2*c-1)/(n+2*c))*u,o/=l=s+a*l,s/=l,u/=l,l=1;return u/n}function r(n,r,i){var a=[.9815606342467192,.9041172563704749,.7699026741943047,.5873179542866175,.3678314989981802,.1252334085114689],o=[.04717533638651183,.10693932599531843,.16007832854334622,.20316742672306592,.2334925365383548,.24914704581340277],s=.5*n;if(s>=8)return 1;var u,l=2*t.normal.cdf(s,0,1,1,0)-1;l=l>=e.exp(-50/i)?e.pow(l,i):0;for(var c=s,f=(8-s)/(u=n>3?2:3),h=c+f,d=0,p=i-1,g=1;g<=u;g++){for(var m=0,v=.5*(h+c),b=.5*(h-c),y=1;y<=12;y++){var w,x=v+b*(6<y?a[(w=12-y+1)-1]:-a[(w=y)-1]),_=x*x;if(_>60)break;var M=2*t.normal.cdf(x,0,1,1,0)*.5-2*t.normal.cdf(x,n,1,1,0)*.5;M>=e.exp(-30/p)&&(m+=M=o[w-1]*e.exp(-.5*_)*e.pow(M,p))}d+=m*=2*b*i/e.sqrt(2*e.PI),c=h,h+=f}return(l+=d)<=e.exp(-30/r)?0:(l=e.pow(l,r))>=1?1:l}!function(e){for(var n=0;n<e.length;n++)!function(e){t[e]=function t(e,n,r){return this instanceof t?(this._a=e,this._b=n,this._c=r,this):new t(e,n,r)},t.fn[e]=function(n,r,i){var a=t[e](n,r,i);return a.data=this,a},t[e].prototype.sample=function(n){var r=this._a,i=this._b,a=this._c;return n?t.alter(n,(function(){return t[e].sample(r,i,a)})):t[e].sample(r,i,a)},function(n){for(var r=0;r<n.length;r++)!function(n){t[e].prototype[n]=function(r){var i=this._a,a=this._b,o=this._c;return r||0===r||(r=this.data),"number"!=typeof r?t.fn.map.call(r,(function(r){return t[e][n](r,i,a,o)})):t[e][n](r,i,a,o)}}(n[r])}("pdf cdf inv".split(" ")),function(n){for(var r=0;r<n.length;r++)!function(n){t[e].prototype[n]=function(){return t[e][n](this._a,this._b,this._c)}}(n[r])}("mean median mode variance".split(" "))}(e[n])}("beta centralF cauchy chisquare exponential gamma invgamma kumaraswamy laplace lognormal noncentralt normal pareto studentt weibull uniform binomial negbin hypgeom poisson triangular tukey arcsine".split(" ")),t.extend(t.beta,{pdf:function(n,r,i){return n>1||n<0?0:1==r&&1==i?1:r<512&&i<512?e.pow(n,r-1)*e.pow(1-n,i-1)/t.betafn(r,i):e.exp((r-1)*e.log(n)+(i-1)*e.log(1-n)-t.betaln(r,i))},cdf:function(e,n,r){return e>1||e<0?1*(e>1):t.ibeta(e,n,r)},inv:function(e,n,r){return t.ibetainv(e,n,r)},mean:function(t,e){return t/(t+e)},median:function(e,n){return t.ibetainv(.5,e,n)},mode:function(t,e){return(t-1)/(t+e-2)},sample:function(e,n){var r=t.randg(e);return r/(r+t.randg(n))},variance:function(t,n){return t*n/(e.pow(t+n,2)*(t+n+1))}}),t.extend(t.centralF,{pdf:function(n,r,i){var a;return n<0?0:r<=2?0===n&&r<2?1/0:0===n&&2===r?1:1/t.betafn(r/2,i/2)*e.pow(r/i,r/2)*e.pow(n,r/2-1)*e.pow(1+r/i*n,-(r+i)/2):(a=r*n/(i+n*r),r*(i/(i+n*r))/2*t.binomial.pdf((r-2)/2,(r+i-2)/2,a))},cdf:function(e,n,r){return e<0?0:t.ibeta(n*e/(n*e+r),n/2,r/2)},inv:function(e,n,r){return r/(n*(1/t.ibetainv(e,n/2,r/2)-1))},mean:function(t,e){return e>2?e/(e-2):void 0},mode:function(t,e){return t>2?e*(t-2)/(t*(e+2)):void 0},sample:function(e,n){return 2*t.randg(e/2)/e/(2*t.randg(n/2)/n)},variance:function(t,e){if(!(e<=4))return 2*e*e*(t+e-2)/(t*(e-2)*(e-2)*(e-4))}}),t.extend(t.cauchy,{pdf:function(t,n,r){return r<0?0:r/(e.pow(t-n,2)+e.pow(r,2))/e.PI},cdf:function(t,n,r){return e.atan((t-n)/r)/e.PI+.5},inv:function(t,n,r){return n+r*e.tan(e.PI*(t-.5))},median:function(t){return t},mode:function(t){return t},sample:function(n,r){return t.randn()*e.sqrt(1/(2*t.randg(.5)))*r+n}}),t.extend(t.chisquare,{pdf:function(n,r){return n<0?0:0===n&&2===r?.5:e.exp((r/2-1)*e.log(n)-n/2-r/2*e.log(2)-t.gammaln(r/2))},cdf:function(e,n){return e<0?0:t.lowRegGamma(n/2,e/2)},inv:function(e,n){return 2*t.gammapinv(e,.5*n)},mean:function(t){return t},median:function(t){return t*e.pow(1-2/(9*t),3)},mode:function(t){return t-2>0?t-2:0},sample:function(e){return 2*t.randg(e/2)},variance:function(t){return 2*t}}),t.extend(t.exponential,{pdf:function(t,n){return t<0?0:n*e.exp(-n*t)},cdf:function(t,n){return t<0?0:1-e.exp(-n*t)},inv:function(t,n){return-e.log(1-t)/n},mean:function(t){return 1/t},median:function(t){return 1/t*e.log(2)},mode:function(){return 0},sample:function(n){return-1/n*e.log(t._random_fn())},variance:function(t){return e.pow(t,-2)}}),t.extend(t.gamma,{pdf:function(n,r,i){return n<0?0:0===n&&1===r?1/i:e.exp((r-1)*e.log(n)-n/i-t.gammaln(r)-r*e.log(i))},cdf:function(e,n,r){return e<0?0:t.lowRegGamma(n,e/r)},inv:function(e,n,r){return t.gammapinv(e,n)*r},mean:function(t,e){return t*e},mode:function(t,e){if(t>1)return(t-1)*e},sample:function(e,n){return t.randg(e)*n},variance:function(t,e){return t*e*e}}),t.extend(t.invgamma,{pdf:function(n,r,i){return n<=0?0:e.exp(-(r+1)*e.log(n)-i/n-t.gammaln(r)+r*e.log(i))},cdf:function(e,n,r){return e<=0?0:1-t.lowRegGamma(n,r/e)},inv:function(e,n,r){return r/t.gammapinv(1-e,n)},mean:function(t,e){return t>1?e/(t-1):void 0},mode:function(t,e){return e/(t+1)},sample:function(e,n){return n/t.randg(e)},variance:function(t,e){if(!(t<=2))return e*e/((t-1)*(t-1)*(t-2))}}),t.extend(t.kumaraswamy,{pdf:function(t,n,r){return 0===t&&1===n?r:1===t&&1===r?n:e.exp(e.log(n)+e.log(r)+(n-1)*e.log(t)+(r-1)*e.log(1-e.pow(t,n)))},cdf:function(t,n,r){return t<0?0:t>1?1:1-e.pow(1-e.pow(t,n),r)},inv:function(t,n,r){return e.pow(1-e.pow(1-t,1/r),1/n)},mean:function(e,n){return n*t.gammafn(1+1/e)*t.gammafn(n)/t.gammafn(1+1/e+n)},median:function(t,n){return e.pow(1-e.pow(2,-1/n),1/t)},mode:function(t,n){if(t>=1&&n>=1&&1!==t&&1!==n)return e.pow((t-1)/(t*n-1),1/t)},variance:function(){throw new Error("variance not yet implemented")}}),t.extend(t.lognormal,{pdf:function(t,n,r){return t<=0?0:e.exp(-e.log(t)-.5*e.log(2*e.PI)-e.log(r)-e.pow(e.log(t)-n,2)/(2*r*r))},cdf:function(n,r,i){return n<0?0:.5+.5*t.erf((e.log(n)-r)/e.sqrt(2*i*i))},inv:function(n,r,i){return e.exp(-1.4142135623730951*i*t.erfcinv(2*n)+r)},mean:function(t,n){return e.exp(t+n*n/2)},median:function(t){return e.exp(t)},mode:function(t,n){return e.exp(t-n*n)},sample:function(n,r){return e.exp(t.randn()*r+n)},variance:function(t,n){return(e.exp(n*n)-1)*e.exp(2*t+n*n)}}),t.extend(t.noncentralt,{pdf:function(n,r,i){return e.abs(i)<1e-14?t.studentt.pdf(n,r):e.abs(n)<1e-14?e.exp(t.gammaln((r+1)/2)-i*i/2-.5*e.log(e.PI*r)-t.gammaln(r/2)):r/n*(t.noncentralt.cdf(n*e.sqrt(1+2/r),r+2,i)-t.noncentralt.cdf(n,r,i))},cdf:function(n,r,i){var a=1e-14;if(e.abs(i)<a)return t.studentt.cdf(n,r);var o=!1;n<0&&(o=!0,i=-i);for(var s=t.normal.cdf(-i,0,1),u=a+1,l=u,c=n*n/(n*n+r),f=0,h=e.exp(-i*i/2),d=e.exp(-i*i/2-.5*e.log(2)-t.gammaln(1.5))*i;f<200||l>a||u>a;)l=u,f>0&&(h*=i*i/(2*f),d*=i*i/(2*(f+.5))),s+=.5*(u=h*t.beta.cdf(c,f+.5,r/2)+d*t.beta.cdf(c,f+1,r/2)),f++;return o?1-s:s}}),t.extend(t.normal,{pdf:function(t,n,r){return e.exp(-.5*e.log(2*e.PI)-e.log(r)-e.pow(t-n,2)/(2*r*r))},cdf:function(n,r,i){return.5*(1+t.erf((n-r)/e.sqrt(2*i*i)))},inv:function(e,n,r){return-1.4142135623730951*r*t.erfcinv(2*e)+n},mean:function(t){return t},median:function(t){return t},mode:function(t){return t},sample:function(e,n){return t.randn()*n+e},variance:function(t,e){return e*e}}),t.extend(t.pareto,{pdf:function(t,n,r){return t<n?0:r*e.pow(n,r)/e.pow(t,r+1)},cdf:function(t,n,r){return t<n?0:1-e.pow(n/t,r)},inv:function(t,n,r){return n/e.pow(1-t,1/r)},mean:function(t,n){if(!(n<=1))return n*e.pow(t,n)/(n-1)},median:function(t,n){return t*(n*e.SQRT2)},mode:function(t){return t},variance:function(t,n){if(!(n<=2))return t*t*n/(e.pow(n-1,2)*(n-2))}}),t.extend(t.studentt,{pdf:function(n,r){return r=r>1e100?1e100:r,1/(e.sqrt(r)*t.betafn(.5,r/2))*e.pow(1+n*n/r,-(r+1)/2)},cdf:function(n,r){var i=r/2;return t.ibeta((n+e.sqrt(n*n+r))/(2*e.sqrt(n*n+r)),i,i)},inv:function(n,r){var i=t.ibetainv(2*e.min(n,1-n),.5*r,.5);return i=e.sqrt(r*(1-i)/i),n>.5?i:-i},mean:function(t){return t>1?0:void 0},median:function(){return 0},mode:function(){return 0},sample:function(n){return t.randn()*e.sqrt(n/(2*t.randg(n/2)))},variance:function(t){return t>2?t/(t-2):t>1?1/0:void 0}}),t.extend(t.weibull,{pdf:function(t,n,r){return t<0||n<0||r<0?0:r/n*e.pow(t/n,r-1)*e.exp(-e.pow(t/n,r))},cdf:function(t,n,r){return t<0?0:1-e.exp(-e.pow(t/n,r))},inv:function(t,n,r){return n*e.pow(-e.log(1-t),1/r)},mean:function(e,n){return e*t.gammafn(1+1/n)},median:function(t,n){return t*e.pow(e.log(2),1/n)},mode:function(t,n){return n<=1?0:t*e.pow((n-1)/n,1/n)},sample:function(n,r){return n*e.pow(-e.log(t._random_fn()),1/r)},variance:function(n,r){return n*n*t.gammafn(1+2/r)-e.pow(t.weibull.mean(n,r),2)}}),t.extend(t.uniform,{pdf:function(t,e,n){return t<e||t>n?0:1/(n-e)},cdf:function(t,e,n){return t<e?0:t<n?(t-e)/(n-e):1},inv:function(t,e,n){return e+t*(n-e)},mean:function(t,e){return.5*(t+e)},median:function(e,n){return t.mean(e,n)},mode:function(){throw new Error("mode is not yet implemented")},sample:function(e,n){return e/2+n/2+(n/2-e/2)*(2*t._random_fn()-1)},variance:function(t,n){return e.pow(n-t,2)/12}}),t.extend(t.binomial,{pdf:function(n,r,i){return 0===i||1===i?r*i===n?1:0:t.combination(r,n)*e.pow(i,n)*e.pow(1-i,r-n)},cdf:function(r,i,a){var o,s=1e-10;if(r<0)return 0;if(r>=i)return 1;if(a<0||a>1||i<=0)return NaN;var u=a,l=(r=e.floor(r))+1,c=i-r,f=l+c,h=e.exp(t.gammaln(f)-t.gammaln(c)-t.gammaln(l)+l*e.log(u)+c*e.log(1-u));return o=u<(l+1)/(f+2)?h*n(u,l,c,s):1-h*n(1-u,c,l,s),e.round(1/s*(1-o))/(1/s)}}),t.extend(t.negbin,{pdf:function(n,r,i){return n===n>>>0&&(n<0?0:t.combination(n+r-1,r-1)*e.pow(1-i,n)*e.pow(i,r))},cdf:function(e,n,r){var i=0,a=0;if(e<0)return 0;for(;a<=e;a++)i+=t.negbin.pdf(a,n,r);return i}}),t.extend(t.hypgeom,{pdf:function(n,r,i,a){if(n!=n|0)return!1;if(n<0||n<i-(r-a))return 0;if(n>a||n>i)return 0;if(2*i>r)return 2*a>r?t.hypgeom.pdf(r-i-a+n,r,r-i,r-a):t.hypgeom.pdf(a-n,r,r-i,a);if(2*a>r)return t.hypgeom.pdf(i-n,r,i,r-a);if(i<a)return t.hypgeom.pdf(n,r,a,i);for(var o=1,s=0,u=0;u<n;u++){for(;o>1&&s<a;)o*=1-i/(r-s),s++;o*=(a-u)*(i-u)/((u+1)*(r-i-a+u+1))}for(;s<a;s++)o*=1-i/(r-s);return e.min(1,e.max(0,o))},cdf:function(n,r,i,a){if(n<0||n<i-(r-a))return 0;if(n>=a||n>=i)return 1;if(2*i>r)return 2*a>r?t.hypgeom.cdf(r-i-a+n,r,r-i,r-a):1-t.hypgeom.cdf(a-n-1,r,r-i,a);if(2*a>r)return 1-t.hypgeom.cdf(i-n-1,r,i,r-a);if(i<a)return t.hypgeom.cdf(n,r,a,i);for(var o=1,s=1,u=0,l=0;l<n;l++){for(;o>1&&u<a;){var c=1-i/(r-u);s*=c,o*=c,u++}o+=s*=(a-l)*(i-l)/((l+1)*(r-i-a+l+1))}for(;u<a;u++)o*=1-i/(r-u);return e.min(1,e.max(0,o))}}),t.extend(t.poisson,{pdf:function(n,r){return r<0||n%1!=0||n<0?0:e.pow(r,n)*e.exp(-r)/t.factorial(n)},cdf:function(e,n){var r=[],i=0;if(e<0)return 0;for(;i<=e;i++)r.push(t.poisson.pdf(i,n));return t.sum(r)},mean:function(t){return t},variance:function(t){return t},sampleSmall:function(n){var r=1,i=0,a=e.exp(-n);do{i++,r*=t._random_fn()}while(r>a);return i-1},sampleLarge:function(n){var r,i,a,o,s,u,l,c,f,h,d=n;for(o=e.sqrt(d),s=e.log(d),u=.02483*(l=.931+2.53*o)-.059,c=1.1239+1.1328/(l-3.4),f=.9277-3.6224/(l-2);;){if(i=e.random()-.5,a=e.random(),h=.5-e.abs(i),r=e.floor((2*u/h+l)*i+d+.43),h>=.07&&a<=f)return r;if(!(r<0||h<.013&&a>h)&&e.log(a)+e.log(c)-e.log(u/(h*h)+l)<=r*s-d-t.loggam(r+1))return r}},sample:function(t){return t<10?this.sampleSmall(t):this.sampleLarge(t)}}),t.extend(t.triangular,{pdf:function(t,e,n,r){return n<=e||r<e||r>n?NaN:t<e||t>n?0:t<r?2*(t-e)/((n-e)*(r-e)):t===r?2/(n-e):2*(n-t)/((n-e)*(n-r))},cdf:function(t,n,r,i){return r<=n||i<n||i>r?NaN:t<=n?0:t>=r?1:t<=i?e.pow(t-n,2)/((r-n)*(i-n)):1-e.pow(r-t,2)/((r-n)*(r-i))},inv:function(t,n,r,i){return r<=n||i<n||i>r?NaN:t<=(i-n)/(r-n)?n+(r-n)*e.sqrt(t*((i-n)/(r-n))):n+(r-n)*(1-e.sqrt((1-t)*(1-(i-n)/(r-n))))},mean:function(t,e,n){return(t+e+n)/3},median:function(t,n,r){return r<=(t+n)/2?n-e.sqrt((n-t)*(n-r))/e.sqrt(2):r>(t+n)/2?t+e.sqrt((n-t)*(r-t))/e.sqrt(2):void 0},mode:function(t,e,n){return n},sample:function(n,r,i){var a=t._random_fn();return a<(i-n)/(r-n)?n+e.sqrt(a*(r-n)*(i-n)):r-e.sqrt((1-a)*(r-n)*(r-i))},variance:function(t,e,n){return(t*t+e*e+n*n-t*e-t*n-e*n)/18}}),t.extend(t.arcsine,{pdf:function(t,n,r){return r<=n?NaN:t<=n||t>=r?0:2/e.PI*e.pow(e.pow(r-n,2)-e.pow(2*t-n-r,2),-.5)},cdf:function(t,n,r){return t<n?0:t<r?2/e.PI*e.asin(e.sqrt((t-n)/(r-n))):1},inv:function(t,n,r){return n+(.5-.5*e.cos(e.PI*t))*(r-n)},mean:function(t,e){return e<=t?NaN:(t+e)/2},median:function(t,e){return e<=t?NaN:(t+e)/2},mode:function(){throw new Error("mode is not yet implemented")},sample:function(n,r){return(n+r)/2+(r-n)/2*e.sin(2*e.PI*t.uniform.sample(0,1))},variance:function(t,n){return n<=t?NaN:e.pow(n-t,2)/8}}),t.extend(t.laplace,{pdf:function(t,n,r){return r<=0?0:e.exp(-e.abs(t-n)/r)/(2*r)},cdf:function(t,n,r){return r<=0?0:t<n?.5*e.exp((t-n)/r):1-.5*e.exp(-(t-n)/r)},mean:function(t){return t},median:function(t){return t},mode:function(t){return t},variance:function(t,e){return 2*e*e},sample:function(n,r){var i,a=t._random_fn()-.5;return n-r*((i=a)/e.abs(i))*e.log(1-2*e.abs(a))}}),t.extend(t.tukey,{cdf:function(n,i,a){var o=i,s=[.9894009349916499,.9445750230732326,.8656312023878318,.755404408355003,.6178762444026438,.45801677765722737,.2816035507792589,.09501250983763744],u=[.027152459411754096,.062253523938647894,.09515851168249279,.12462897125553388,.14959598881657674,.16915651939500254,.18260341504492358,.1894506104550685];if(n<=0)return 0;if(a<2||o<2)return NaN;if(!Number.isFinite(n))return 1;if(a>25e3)return r(n,1,o);var l,c=.5*a,f=c*e.log(a)-a*e.log(2)-t.gammaln(c),h=c-1,d=.25*a;l=a<=100?1:a<=800?.5:a<=5e3?.25:.125,f+=e.log(l);for(var p=0,g=1;g<=50;g++){for(var m=0,v=(2*g-1)*l,b=1;b<=16;b++){var y,w;8<b?(y=b-8-1,w=f+h*e.log(v+s[y]*l)-(s[y]*l+v)*d):(y=b-1,w=f+h*e.log(v-s[y]*l)+(s[y]*l-v)*d),w>=-30&&(m+=r(8<b?n*e.sqrt(.5*(s[y]*l+v)):n*e.sqrt(.5*(-s[y]*l+v)),1,o)*u[y]*e.exp(w))}if(g*l>=1&&m<=1e-14)break;p+=m}if(m>1e-14)throw new Error("tukey.cdf failed to converge");return p>1&&(p=1),p},inv:function(n,r,i){if(i<2||r<2)return NaN;if(n<0||n>1)return NaN;if(0===n)return 0;if(1===n)return 1/0;var a,o=function(t,n,r){var i=.5-.5*t,a=e.sqrt(e.log(1/(i*i))),o=a+((((-453642210148e-16*a-.204231210125)*a-.342242088547)*a-1)*a+.322232421088)/((((.0038560700634*a+.10353775285)*a+.531103462366)*a+.588581570495)*a+.099348462606);r<120&&(o+=(o*o*o+o)/r/4);var s=.8832-.2368*o;return r<120&&(s+=-1.214/r+1.208*o/r),o*(s*e.log(n-1)+1.4142)}(n,r,i),s=t.tukey.cdf(o,r,i)-n;a=s>0?e.max(0,o-1):o+1;for(var u,l=t.tukey.cdf(a,r,i)-n,c=1;c<50;c++)if(u=a-l*(a-o)/(l-s),s=l,o=a,u<0&&(u=0,l=-n),l=t.tukey.cdf(u,r,i)-n,a=u,e.abs(a-o)<1e-4)return u;throw new Error("tukey.inv failed to converge")}})}(e,Math),function(t,e){var n,r,i=Array.prototype.push,a=t.utils.isArray;function o(e){return a(e)||e instanceof t}t.extend({add:function(e,n){return o(n)?(o(n[0])||(n=[n]),t.map(e,(function(t,e,r){return t+n[e][r]}))):t.map(e,(function(t){return t+n}))},subtract:function(e,n){return o(n)?(o(n[0])||(n=[n]),t.map(e,(function(t,e,r){return t-n[e][r]||0}))):t.map(e,(function(t){return t-n}))},divide:function(e,n){return o(n)?(o(n[0])||(n=[n]),t.multiply(e,t.inv(n))):t.map(e,(function(t){return t/n}))},multiply:function(e,n){var r,i,a,s,u,l,c,f;if(void 0===e.length&&void 0===n.length)return e*n;if(u=e.length,l=e[0].length,c=t.zeros(u,a=o(n)?n[0].length:l),f=0,o(n)){for(;f<a;f++)for(r=0;r<u;r++){for(s=0,i=0;i<l;i++)s+=e[r][i]*n[i][f];c[r][f]=s}return 1===u&&1===f?c[0][0]:c}return t.map(e,(function(t){return t*n}))},outer:function(e,n){return t.multiply(e.map((function(t){return[t]})),[n])},dot:function(e,n){o(e[0])||(e=[e]),o(n[0])||(n=[n]);for(var r,i,a=1===e[0].length&&1!==e.length?t.transpose(e):e,s=1===n[0].length&&1!==n.length?t.transpose(n):n,u=[],l=0,c=a.length,f=a[0].length;l<c;l++){for(u[l]=[],r=0,i=0;i<f;i++)r+=a[l][i]*s[l][i];u[l]=r}return 1===u.length?u[0]:u},pow:function(n,r){return t.map(n,(function(t){return e.pow(t,r)}))},exp:function(n){return t.map(n,(function(t){return e.exp(t)}))},log:function(n){return t.map(n,(function(t){return e.log(t)}))},abs:function(n){return t.map(n,(function(t){return e.abs(t)}))},norm:function(t,n){var r=0,i=0;for(isNaN(n)&&(n=2),o(t[0])&&(t=t[0]);i<t.length;i++)r+=e.pow(e.abs(t[i]),n);return e.pow(r,1/n)},angle:function(n,r){return e.acos(t.dot(n,r)/(t.norm(n)*t.norm(r)))},aug:function(t,e){var n,r=[];for(n=0;n<t.length;n++)r.push(t[n].slice());for(n=0;n<r.length;n++)i.apply(r[n],e[n]);return r},inv:function(e){for(var n,r=e.length,i=e[0].length,a=t.identity(r,i),o=t.gauss_jordan(e,a),s=[],u=0;u<r;u++)for(s[u]=[],n=i;n<o[0].length;n++)s[u][n-i]=o[u][n];return s},det:function(t){var e,n=t.length,r=2*n,i=new Array(r),a=n-1,o=r-1,s=a-n+1,u=o,l=0,c=0;if(2===n)return t[0][0]*t[1][1]-t[0][1]*t[1][0];for(;l<r;l++)i[l]=1;for(l=0;l<n;l++){for(e=0;e<n;e++)i[s<0?s+n:s]*=t[l][e],i[u<n?u+n:u]*=t[l][e],s++,u--;s=--a-n+1,u=--o}for(l=0;l<n;l++)c+=i[l];for(;l<r;l++)c-=i[l];return c},gauss_elimination:function(n,r){var i,a,o,s,u=0,l=0,c=n.length,f=n[0].length,h=1,d=0,p=[];for(i=(n=t.aug(n,r))[0].length,u=0;u<c;u++){for(a=n[u][u],l=u,s=u+1;s<f;s++)a<e.abs(n[s][u])&&(a=n[s][u],l=s);if(l!=u)for(s=0;s<i;s++)o=n[u][s],n[u][s]=n[l][s],n[l][s]=o;for(l=u+1;l<c;l++)for(h=n[l][u]/n[u][u],s=u;s<i;s++)n[l][s]=n[l][s]-h*n[u][s]}for(u=c-1;u>=0;u--){for(d=0,l=u+1;l<=c-1;l++)d+=p[l]*n[u][l];p[u]=(n[u][i-1]-d)/n[u][u]}return p},gauss_jordan:function(n,r){var i,a,o,s=t.aug(n,r),u=s.length,l=s[0].length,c=0;for(a=0;a<u;a++){var f=a;for(o=a+1;o<u;o++)e.abs(s[o][a])>e.abs(s[f][a])&&(f=o);var h=s[a];for(s[a]=s[f],s[f]=h,o=a+1;o<u;o++)for(c=s[o][a]/s[a][a],i=a;i<l;i++)s[o][i]-=s[a][i]*c}for(a=u-1;a>=0;a--){for(c=s[a][a],o=0;o<a;o++)for(i=l-1;i>a-1;i--)s[o][i]-=s[a][i]*s[o][a]/c;for(s[a][a]/=c,i=u;i<l;i++)s[a][i]/=c}return s},triaUpSolve:function(e,n){var r,i=e[0].length,a=t.zeros(1,i)[0],o=!1;return null!=n[0].length&&(n=n.map((function(t){return t[0]})),o=!0),t.arange(i-1,-1,-1).forEach((function(o){r=t.arange(o+1,i).map((function(t){return a[t]*e[o][t]})),a[o]=(n[o]-t.sum(r))/e[o][o]})),o?a.map((function(t){return[t]})):a},triaLowSolve:function(e,n){var r,i=e[0].length,a=t.zeros(1,i)[0],o=!1;return null!=n[0].length&&(n=n.map((function(t){return t[0]})),o=!0),t.arange(i).forEach((function(i){r=t.arange(i).map((function(t){return e[i][t]*a[t]})),a[i]=(n[i]-t.sum(r))/e[i][i]})),o?a.map((function(t){return[t]})):a},lu:function(e){var n,r=e.length,i=t.identity(r),a=t.zeros(e.length,e[0].length);return t.arange(r).forEach((function(t){a[0][t]=e[0][t]})),t.arange(1,r).forEach((function(o){t.arange(o).forEach((function(r){n=t.arange(r).map((function(t){return i[o][t]*a[t][r]})),i[o][r]=(e[o][r]-t.sum(n))/a[r][r]})),t.arange(o,r).forEach((function(r){n=t.arange(o).map((function(t){return i[o][t]*a[t][r]})),a[o][r]=e[n.length][r]-t.sum(n)}))})),[i,a]},cholesky:function(n){var r,i=n.length,a=t.zeros(n.length,n[0].length);return t.arange(i).forEach((function(o){r=t.arange(o).map((function(t){return e.pow(a[o][t],2)})),a[o][o]=e.sqrt(n[o][o]-t.sum(r)),t.arange(o+1,i).forEach((function(e){r=t.arange(o).map((function(t){return a[o][t]*a[e][t]})),a[e][o]=(n[o][e]-t.sum(r))/a[o][o]}))})),a},gauss_jacobi:function(n,r,i,a){for(var o,s,u,l,c=0,f=0,h=n.length,d=[],p=[],g=[];c<h;c++)for(d[c]=[],p[c]=[],g[c]=[],f=0;f<h;f++)c>f?(d[c][f]=n[c][f],p[c][f]=g[c][f]=0):c<f?(p[c][f]=n[c][f],d[c][f]=g[c][f]=0):(g[c][f]=n[c][f],d[c][f]=p[c][f]=0);for(u=t.multiply(t.multiply(t.inv(g),t.add(d,p)),-1),s=t.multiply(t.inv(g),r),o=i,l=t.add(t.multiply(u,i),s),c=2;e.abs(t.norm(t.subtract(l,o)))>a;)o=l,l=t.add(t.multiply(u,o),s),c++;return l},gauss_seidel:function(n,r,i,a){for(var o,s,u,l,c,f=0,h=n.length,d=[],p=[],g=[];f<h;f++)for(d[f]=[],p[f]=[],g[f]=[],o=0;o<h;o++)f>o?(d[f][o]=n[f][o],p[f][o]=g[f][o]=0):f<o?(p[f][o]=n[f][o],d[f][o]=g[f][o]=0):(g[f][o]=n[f][o],d[f][o]=p[f][o]=0);for(l=t.multiply(t.multiply(t.inv(t.add(g,d)),p),-1),u=t.multiply(t.inv(t.add(g,d)),r),s=i,c=t.add(t.multiply(l,i),u),f=2;e.abs(t.norm(t.subtract(c,s)))>a;)s=c,c=t.add(t.multiply(l,s),u),f+=1;return c},SOR:function(n,r,i,a,o){for(var s,u,l,c,f,h=0,d=n.length,p=[],g=[],m=[];h<d;h++)for(p[h]=[],g[h]=[],m[h]=[],s=0;s<d;s++)h>s?(p[h][s]=n[h][s],g[h][s]=m[h][s]=0):h<s?(g[h][s]=n[h][s],p[h][s]=m[h][s]=0):(m[h][s]=n[h][s],p[h][s]=g[h][s]=0);for(c=t.multiply(t.inv(t.add(m,t.multiply(p,o))),t.subtract(t.multiply(m,1-o),t.multiply(g,o))),l=t.multiply(t.multiply(t.inv(t.add(m,t.multiply(p,o))),r),o),u=i,f=t.add(t.multiply(c,i),l),h=2;e.abs(t.norm(t.subtract(f,u)))>a;)u=f,f=t.add(t.multiply(c,u),l),h++;return f},householder:function(n){for(var r,i,a,o,s=n.length,u=n[0].length,l=0,c=[],f=[];l<s-1;l++){for(r=0,o=l+1;o<u;o++)r+=n[o][l]*n[o][l];for(r=(n[l+1][l]>0?-1:1)*e.sqrt(r),i=e.sqrt((r*r-n[l+1][l]*r)/2),(c=t.zeros(s,1))[l+1][0]=(n[l+1][l]-r)/(2*i),a=l+2;a<s;a++)c[a][0]=n[a][l]/(2*i);f=t.subtract(t.identity(s,u),t.multiply(t.multiply(c,t.transpose(c)),2)),n=t.multiply(f,t.multiply(n,f))}return n},QR:(n=t.sum,r=t.arange,function(i){var a,o,s,u=i.length,l=i[0].length,c=t.zeros(l,l);for(i=t.copy(i),o=0;o<l;o++){for(c[o][o]=e.sqrt(n(r(u).map((function(t){return i[t][o]*i[t][o]})))),a=0;a<u;a++)i[a][o]=i[a][o]/c[o][o];for(s=o+1;s<l;s++)for(c[o][s]=n(r(u).map((function(t){return i[t][o]*i[t][s]}))),a=0;a<u;a++)i[a][s]=i[a][s]-i[a][o]*c[o][s]}return[i,c]}),lstsq:function(e,n){var r=!1;void 0===n[0].length&&(n=n.map((function(t){return[t]})),r=!0);var i=t.QR(e),a=i[0],o=i[1],s=e[0].length,u=t.slice(a,{col:{end:s}}),l=function(e){var n=(e=t.copy(e)).length,r=t.identity(n);return t.arange(n-1,-1,-1).forEach((function(n){t.sliceAssign(r,{row:n},t.divide(t.slice(r,{row:n}),e[n][n])),t.sliceAssign(e,{row:n},t.divide(t.slice(e,{row:n}),e[n][n])),t.arange(n).forEach((function(i){var a=t.multiply(e[i][n],-1),o=t.slice(e,{row:i}),s=t.multiply(t.slice(e,{row:n}),a);t.sliceAssign(e,{row:i},t.add(o,s));var u=t.slice(r,{row:i}),l=t.multiply(t.slice(r,{row:n}),a);t.sliceAssign(r,{row:i},t.add(u,l))}))})),r}(t.slice(o,{row:{end:s}})),c=t.transpose(u);void 0===c[0].length&&(c=[c]);var f=t.multiply(t.multiply(l,c),n);return void 0===f.length&&(f=[[f]]),r?f.map((function(t){return t[0]})):f},jacobi:function(n){for(var r,i,a,o,s,u,l,c=1,f=n.length,h=t.identity(f,f),d=[];1===c;){for(s=n[0][1],a=0,o=1,r=0;r<f;r++)for(i=0;i<f;i++)r!=i&&s<e.abs(n[r][i])&&(s=e.abs(n[r][i]),a=r,o=i);for(u=n[a][a]===n[o][o]?n[a][o]>0?e.PI/4:-e.PI/4:e.atan(2*n[a][o]/(n[a][a]-n[o][o]))/2,(l=t.identity(f,f))[a][a]=e.cos(u),l[a][o]=-e.sin(u),l[o][a]=e.sin(u),l[o][o]=e.cos(u),h=t.multiply(h,l),n=t.multiply(t.multiply(t.inv(l),n),l),c=0,r=1;r<f;r++)for(i=1;i<f;i++)r!=i&&e.abs(n[r][i])>.001&&(c=1)}for(r=0;r<f;r++)d.push(n[r][r]);return[h,d]},rungekutta:function(t,e,n,r,i,a){var o,s,u;if(2===a)for(;r<=n;)i+=((o=e*t(r,i))+(s=e*t(r+e,i+o)))/2,r+=e;if(4===a)for(;r<=n;)i+=((o=e*t(r,i))+2*(s=e*t(r+e/2,i+o/2))+2*(u=e*t(r+e/2,i+s/2))+e*t(r+e,i+u))/6,r+=e;return i},romberg:function(t,n,r,i){for(var a,o,s,u,l,c=0,f=(r-n)/2,h=[],d=[],p=[];c<i/2;){for(l=t(n),s=n,u=0;s<=r;s+=f,u++)h[u]=s;for(a=h.length,s=1;s<a-1;s++)l+=(s%2!=0?4:2)*t(h[s]);l=f/3*(l+t(r)),p[c]=l,f/=2,c++}for(o=p.length,a=1;1!==o;){for(s=0;s<o-1;s++)d[s]=(e.pow(4,a)*p[s+1]-p[s])/(e.pow(4,a)-1);o=d.length,p=d,d=[],a++}return p},richardson:function(t,n,r,i){function a(t,e){for(var n,r=0,i=t.length;r<i;r++)t[r]===e&&(n=r);return n}for(var o,s,u,l,c,f=e.abs(r-t[a(t,r)+1]),h=0,d=[],p=[];i>=f;)o=a(t,r+i),s=a(t,r),d[h]=(n[o]-2*n[s]+n[2*s-o])/(i*i),i/=2,h++;for(l=d.length,u=1;1!=l;){for(c=0;c<l-1;c++)p[c]=(e.pow(4,u)*d[c+1]-d[c])/(e.pow(4,u)-1);l=p.length,d=p,p=[],u++}return d},simpson:function(t,e,n,r){for(var i,a=(n-e)/r,o=t(e),s=[],u=e,l=0,c=1;u<=n;u+=a,l++)s[l]=u;for(i=s.length;c<i-1;c++)o+=(c%2!=0?4:2)*t(s[c]);return a/3*(o+t(n))},hermite:function(t,e,n,r){for(var i,a=t.length,o=0,s=0,u=[],l=[],c=[],f=[];s<a;s++){for(u[s]=1,i=0;i<a;i++)s!=i&&(u[s]*=(r-t[i])/(t[s]-t[i]));for(l[s]=0,i=0;i<a;i++)s!=i&&(l[s]+=1/(t[s]-t[i]));c[s]=(1-2*(r-t[s])*l[s])*(u[s]*u[s]),f[s]=(r-t[s])*(u[s]*u[s]),o+=c[s]*e[s]+f[s]*n[s]}return o},lagrange:function(t,e,n){for(var r,i,a=0,o=0,s=t.length;o<s;o++){for(i=e[o],r=0;r<s;r++)o!=r&&(i*=(n-t[r])/(t[o]-t[r]));a+=i}return a},cubic_spline:function(e,n,r){for(var i,a,o=e.length,s=0,u=[],l=[],c=[],f=[],h=[],d=[];s<o-1;s++)f[s]=e[s+1]-e[s];for(c[0]=0,s=1;s<o-1;s++)c[s]=3/f[s]*(n[s+1]-n[s])-3/f[s-1]*(n[s]-n[s-1]);for(s=1;s<o-1;s++)u[s]=[],l[s]=[],u[s][s-1]=f[s-1],u[s][s]=2*(f[s-1]+f[s]),u[s][s+1]=f[s],l[s][0]=c[s];for(a=t.multiply(t.inv(u),l),i=0;i<o-1;i++)h[i]=(n[i+1]-n[i])/f[i]-f[i]*(a[i+1][0]+2*a[i][0])/3,d[i]=(a[i+1][0]-a[i][0])/(3*f[i]);for(i=0;i<o&&!(e[i]>r);i++);return n[i-=1]+(r-e[i])*h[i]+t.sq(r-e[i])*a[i]+(r-e[i])*t.sq(r-e[i])*d[i]},gauss_quadrature:function(){throw new Error("gauss_quadrature not yet implemented")},PCA:function(e){var n,r,i,a,o,s=e.length,u=e[0].length,l=0,c=[],f=[],h=[],d=[],p=[],g=[],m=[];for(l=0;l<s;l++)c[l]=t.sum(e[l])/u;for(l=0;l<u;l++)for(p[l]=[],n=0;n<s;n++)p[l][n]=e[n][l]-c[n];for(p=t.transpose(p),l=0;l<s;l++)for(g[l]=[],n=0;n<s;n++)g[l][n]=t.dot([p[l]],[p[n]])/(u-1);for(o=(i=t.jacobi(g))[0],f=i[1],m=t.transpose(o),l=0;l<f.length;l++)for(n=l;n<f.length;n++)f[l]<f[n]&&(r=f[l],f[l]=f[n],f[n]=r,h=m[l],m[l]=m[n],m[n]=h);for(a=t.transpose(p),l=0;l<s;l++)for(d[l]=[],n=0;n<a.length;n++)d[l][n]=t.dot([m[l]],[a[n]]);return[e,f,m,d]}}),function(e){for(var n=0;n<e.length;n++)!function(e){t.fn[e]=function(n,r){var i=this;return r?(setTimeout((function(){r.call(i,t.fn[e].call(i,n))}),15),this):"number"==typeof t[e](this,n)?t[e](this,n):t(t[e](this,n))}}(e[n])}("add divide multiply subtract dot pow exp log abs norm angle".split(" "))}(e,Math),function(t,e){var n=[].slice,r=t.utils.isNumber,i=t.utils.isArray;function a(t,n,r,i){if(t>1||r>1||t<=0||r<=0)throw new Error("Proportions should be greater than 0 and less than 1");var a=(t*n+r*i)/(n+i);return(t-r)/e.sqrt(a*(1-a)*(1/n+1/i))}t.extend({zscore:function(){var e=n.call(arguments);return r(e[1])?(e[0]-e[1])/e[2]:(e[0]-t.mean(e[1]))/t.stdev(e[1],e[2])},ztest:function(){var r,a=n.call(arguments);return i(a[1])?(r=t.zscore(a[0],a[1],a[3]),1===a[2]?t.normal.cdf(-e.abs(r),0,1):2*t.normal.cdf(-e.abs(r),0,1)):a.length>2?(r=t.zscore(a[0],a[1],a[2]),1===a[3]?t.normal.cdf(-e.abs(r),0,1):2*t.normal.cdf(-e.abs(r),0,1)):(r=a[0],1===a[1]?t.normal.cdf(-e.abs(r),0,1):2*t.normal.cdf(-e.abs(r),0,1))}}),t.extend(t.fn,{zscore:function(t,e){return(t-this.mean())/this.stdev(e)},ztest:function(n,r,i){var a=e.abs(this.zscore(n,i));return 1===r?t.normal.cdf(-a,0,1):2*t.normal.cdf(-a,0,1)}}),t.extend({tscore:function(){var r=n.call(arguments);return 4===r.length?(r[0]-r[1])/(r[2]/e.sqrt(r[3])):(r[0]-t.mean(r[1]))/(t.stdev(r[1],!0)/e.sqrt(r[1].length))},ttest:function(){var i,a=n.call(arguments);return 5===a.length?(i=e.abs(t.tscore(a[0],a[1],a[2],a[3])),1===a[4]?t.studentt.cdf(-i,a[3]-1):2*t.studentt.cdf(-i,a[3]-1)):r(a[1])?(i=e.abs(a[0]),1==a[2]?t.studentt.cdf(-i,a[1]-1):2*t.studentt.cdf(-i,a[1]-1)):(i=e.abs(t.tscore(a[0],a[1])),1==a[2]?t.studentt.cdf(-i,a[1].length-1):2*t.studentt.cdf(-i,a[1].length-1))}}),t.extend(t.fn,{tscore:function(t){return(t-this.mean())/(this.stdev(!0)/e.sqrt(this.cols()))},ttest:function(n,r){return 1===r?1-t.studentt.cdf(e.abs(this.tscore(n)),this.cols()-1):2*t.studentt.cdf(-e.abs(this.tscore(n)),this.cols()-1)}}),t.extend({anovafscore:function(){var r,i,a,o,s,u,l,c,f=n.call(arguments);if(1===f.length){for(s=new Array(f[0].length),l=0;l<f[0].length;l++)s[l]=f[0][l];f=s}for(i=new Array,l=0;l<f.length;l++)i=i.concat(f[l]);for(a=t.mean(i),r=0,l=0;l<f.length;l++)r+=f[l].length*e.pow(t.mean(f[l])-a,2);for(r/=f.length-1,u=0,l=0;l<f.length;l++)for(o=t.mean(f[l]),c=0;c<f[l].length;c++)u+=e.pow(f[l][c]-o,2);return r/(u/(i.length-f.length))},anovaftest:function(){var e,i,a,o,s=n.call(arguments);if(r(s[0]))return 1-t.centralF.cdf(s[0],s[1],s[2]);var u=t.anovafscore(s);for(e=s.length-1,a=0,o=0;o<s.length;o++)a+=s[o].length;return i=a-e-1,1-t.centralF.cdf(u,e,i)},ftest:function(e,n,r){return 1-t.centralF.cdf(e,n,r)}}),t.extend(t.fn,{anovafscore:function(){return t.anovafscore(this.toArray())},anovaftes:function(){var e,n=0;for(e=0;e<this.length;e++)n+=this[e].length;return t.ftest(this.anovafscore(),this.length-1,n-this.length)}}),t.extend({qscore:function(){var i,a,o,s,u,l=n.call(arguments);return r(l[0])?(i=l[0],a=l[1],o=l[2],s=l[3],u=l[4]):(i=t.mean(l[0]),a=t.mean(l[1]),o=l[0].length,s=l[1].length,u=l[2]),e.abs(i-a)/(u*e.sqrt((1/o+1/s)/2))},qtest:function(){var e,r=n.call(arguments);3===r.length?(e=r[0],r=r.slice(1)):7===r.length?(e=t.qscore(r[0],r[1],r[2],r[3],r[4]),r=r.slice(5)):(e=t.qscore(r[0],r[1],r[2]),r=r.slice(3));var i=r[0],a=r[1];return 1-t.tukey.cdf(e,a,i-a)},tukeyhsd:function(e){for(var n=t.pooledstdev(e),r=e.map((function(e){return t.mean(e)})),i=e.reduce((function(t,e){return t+e.length}),0),a=[],o=0;o<e.length;++o)for(var s=o+1;s<e.length;++s){var u=t.qtest(r[o],r[s],e[o].length,e[s].length,n,i,e.length);a.push([[o,s],u])}return a}}),t.extend({normalci:function(){var r,i=n.call(arguments),a=new Array(2);return r=4===i.length?e.abs(t.normal.inv(i[1]/2,0,1)*i[2]/e.sqrt(i[3])):e.abs(t.normal.inv(i[1]/2,0,1)*t.stdev(i[2])/e.sqrt(i[2].length)),a[0]=i[0]-r,a[1]=i[0]+r,a},tci:function(){var r,i=n.call(arguments),a=new Array(2);return r=4===i.length?e.abs(t.studentt.inv(i[1]/2,i[3]-1)*i[2]/e.sqrt(i[3])):e.abs(t.studentt.inv(i[1]/2,i[2].length-1)*t.stdev(i[2],!0)/e.sqrt(i[2].length)),a[0]=i[0]-r,a[1]=i[0]+r,a},significant:function(t,e){return t<e}}),t.extend(t.fn,{normalci:function(e,n){return t.normalci(e,n,this.toArray())},tci:function(e,n){return t.tci(e,n,this.toArray())}}),t.extend(t.fn,{oneSidedDifferenceOfProportions:function(e,n,r,i){var o=a(e,n,r,i);return t.ztest(o,1)},twoSidedDifferenceOfProportions:function(e,n,r,i){var o=a(e,n,r,i);return t.ztest(o,2)}})}(e,Math),e.models=function(){function t(t,n){var r=t.length,i=n[0].length-1,a=r-i-1,o=e.lstsq(n,t),s=e.multiply(n,o.map((function(t){return[t]}))).map((function(t){return t[0]})),u=e.subtract(t,s),l=e.mean(t),c=e.sum(s.map((function(t){return Math.pow(t-l,2)}))),f=e.sum(t.map((function(t,e){return Math.pow(t-s[e],2)}))),h=c+f;return{exog:n,endog:t,nobs:r,df_model:i,df_resid:a,coef:o,predict:s,resid:u,ybar:l,SST:h,SSE:c,SSR:f,R2:c/h}}function n(n){var r,i,a=(r=n.exog,i=r[0].length,e.arange(i).map((function(n){var a=e.arange(i).filter((function(t){return t!==n}));return t(e.col(r,n).map((function(t){return t[0]})),e.col(r,a))}))),o=Math.sqrt(n.SSR/n.df_resid),s=a.map((function(t){var e=t.SST,n=t.R2;return o/Math.sqrt(e*(1-n))})),u=n.coef.map((function(t,e){return(t-0)/s[e]})),l=u.map((function(t){var r=e.studentt.cdf(t,n.df_resid);return 2*(r>.5?1-r:r)})),c=e.studentt.inv(.975,n.df_resid),f=n.coef.map((function(t,e){var n=c*s[e];return[t-n,t+n]}));return{se:s,t:u,p:l,sigmaHat:o,interval95:f}}return{ols:function(r,i){var a=t(r,i),o=n(a),s=function(t){var n,r,i,a=t.R2/t.df_model/((1-t.R2)/t.df_resid);return{F_statistic:a,pvalue:1-(n=a,r=t.df_model,i=t.df_resid,e.beta.cdf(n/(i/r+n),r/2,i/2))}}(a),u=1-(1-a.R2)*((a.nobs-1)/a.df_resid);return a.t=o,a.f=s,a.adjust_R2=u,a}}}(),e.extend({buildxmatrix:function(){for(var t=new Array(arguments.length),n=0;n<arguments.length;n++){var r=[1];t[n]=r.concat(arguments[n])}return e(t)},builddxmatrix:function(){for(var t=new Array(arguments[0].length),n=0;n<arguments[0].length;n++){var r=[1];t[n]=r.concat(arguments[0][n])}return e(t)},buildjxmatrix:function(t){for(var n=new Array(t.length),r=0;r<t.length;r++)n[r]=t[r];return e.builddxmatrix(n)},buildymatrix:function(t){return e(t).transpose()},buildjymatrix:function(t){return t.transpose()},matrixmult:function(t,n){var r,i,a,o,s;if(t.cols()==n.rows()){if(n.rows()>1){for(o=[],r=0;r<t.rows();r++)for(o[r]=[],i=0;i<n.cols();i++){for(s=0,a=0;a<t.cols();a++)s+=t.toArray()[r][a]*n.toArray()[a][i];o[r][i]=s}return e(o)}for(o=[],r=0;r<t.rows();r++)for(o[r]=[],i=0;i<n.cols();i++){for(s=0,a=0;a<t.cols();a++)s+=t.toArray()[r][a]*n.toArray()[i];o[r][i]=s}return e(o)}},regress:function(t,n){var r=e.xtranspxinv(t),i=t.transpose(),a=e.matrixmult(e(r),i);return e.matrixmult(a,n)},regresst:function(t,n,r){var i=e.regress(t,n),a={anova:{}},o=e.jMatYBar(t,i);a.yBar=o;var s=n.mean();a.anova.residuals=e.residuals(n,o),a.anova.ssr=e.ssr(o,s),a.anova.msr=a.anova.ssr/(t[0].length-1),a.anova.sse=e.sse(n,o),a.anova.mse=a.anova.sse/(n.length-(t[0].length-1)-1),a.anova.sst=e.sst(n,s),a.anova.mst=a.anova.sst/(n.length-1),a.anova.r2=1-a.anova.sse/a.anova.sst,a.anova.r2<0&&(a.anova.r2=0),a.anova.fratio=a.anova.msr/a.anova.mse,a.anova.pvalue=e.anovaftest(a.anova.fratio,t[0].length-1,n.length-(t[0].length-1)-1),a.anova.rmse=Math.sqrt(a.anova.mse),a.anova.r2adj=1-a.anova.mse/a.anova.mst,a.anova.r2adj<0&&(a.anova.r2adj=0),a.stats=new Array(t[0].length);for(var u,l,c,f=e.xtranspxinv(t),h=0;h<i.length;h++)u=Math.sqrt(a.anova.mse*Math.abs(f[h][h])),l=Math.abs(i[h]/u),c=e.ttest(l,n.length-t[0].length-1,r),a.stats[h]=[i[h],u,l,c];return a.regress=i,a},xtranspx:function(t){return e.matrixmult(t.transpose(),t)},xtranspxinv:function(t){var n=e.matrixmult(t.transpose(),t);return e.inv(n)},jMatYBar:function(t,n){var r=e.matrixmult(t,n);return new e(r)},residuals:function(t,n){return e.matrixsubtract(t,n)},ssr:function(t,e){for(var n=0,r=0;r<t.length;r++)n+=Math.pow(t[r]-e,2);return n},sse:function(t,e){for(var n=0,r=0;r<t.length;r++)n+=Math.pow(t[r]-e[r],2);return n},sst:function(t,e){for(var n=0,r=0;r<t.length;r++)n+=Math.pow(t[r]-e,2);return n},matrixsubtract:function(t,n){for(var r=new Array(t.length),i=0;i<t.length;i++){r[i]=new Array(t[i].length);for(var a=0;a<t[i].length;a++)r[i][a]=t[i][a]-n[i][a]}return e(r)}}),e.jStat=e,e)},409:function(t,e){!function(t){"use strict";t.SVD=function(t,e,n,r,i){if(e=void 0===e||e,n=void 0===n||n,i=1e-64/(r=r||Math.pow(2,-52)),!t)throw new TypeError("Matrix a is not defined");var a,o,s,u,l,c,f,h,d,p,g,m,v=t[0].length,b=t.length;if(b<v)throw new TypeError("Invalid matrix: m < n");for(var y=[],w=[],x=[],_="f"===e?b:v,M=p=f=0;M<b;M++)w[M]=new Array(_).fill(0);for(M=0;M<v;M++)x[M]=new Array(v).fill(0);var k,A=new Array(v).fill(0);for(M=0;M<b;M++)for(a=0;a<v;a++)w[M][a]=t[M][a];for(M=0;M<v;M++){for(y[M]=f,d=0,s=M+1,a=M;a<b;a++)d+=Math.pow(w[a][M],2);if(d<i)f=0;else for(h=(c=w[M][M])*(f=c<0?Math.sqrt(d):-Math.sqrt(d))-d,w[M][M]=c-f,a=s;a<v;a++){for(d=0,o=M;o<b;o++)d+=w[o][M]*w[o][a];for(c=d/h,o=M;o<b;o++)w[o][a]=w[o][a]+c*w[o][M]}for(A[M]=f,d=0,a=s;a<v;a++)d+=Math.pow(w[M][a],2);if(d<i)f=0;else{for(h=(c=w[M][M+1])*(f=c<0?Math.sqrt(d):-Math.sqrt(d))-d,w[M][M+1]=c-f,a=s;a<v;a++)y[a]=w[M][a]/h;for(a=s;a<b;a++){for(d=0,o=s;o<v;o++)d+=w[a][o]*w[M][o];for(o=s;o<v;o++)w[a][o]=w[a][o]+d*y[o]}}p<(g=Math.abs(A[M])+Math.abs(y[M]))&&(p=g)}if(n)for(M=v-1;0<=M;M--){if(0!==f){for(h=w[M][M+1]*f,a=s;a<v;a++)x[a][M]=w[M][a]/h;for(a=s;a<v;a++){for(d=0,o=s;o<v;o++)d+=w[M][o]*x[o][a];for(o=s;o<v;o++)x[o][a]=x[o][a]+d*x[o][M]}}for(a=s;a<v;a++)x[M][a]=0,x[a][M]=0;x[M][M]=1,f=y[M],s=M}if(e){if("f"===e)for(M=v;M<b;M++){for(a=v;a<b;a++)w[M][a]=0;w[M][M]=1}for(M=v-1;0<=M;M--){for(s=M+1,f=A[M],a=s;a<_;a++)w[M][a]=0;if(0!==f){for(h=w[M][M]*f,a=s;a<_;a++){for(d=0,o=s;o<b;o++)d+=w[o][M]*w[o][a];for(c=d/h,o=M;o<b;o++)w[o][a]=w[o][a]+c*w[o][M]}for(a=M;a<b;a++)w[a][M]=w[a][M]/f}else for(a=M;a<b;a++)w[a][M]=0;w[M][M]=w[M][M]+1}}for(r*=p,o=v-1;0<=o;o--)for(var S=0;S<50;S++){for(k=!1,s=o;0<=s;s--){if(Math.abs(y[s])<=r){k=!0;break}if(Math.abs(A[s-1])<=r)break}if(!k)for(l=0,u=s-(d=1),M=s;M<o+1&&(c=d*y[M],y[M]=l*y[M],!(Math.abs(c)<=r));M++)if(f=A[M],A[M]=Math.sqrt(c*c+f*f),l=f/(h=A[M]),d=-c/h,e)for(a=0;a<b;a++)g=w[a][u],m=w[a][M],w[a][u]=g*l+m*d,w[a][M]=-g*d+m*l;if(m=A[o],s===o){if(m<0&&(A[o]=-m,n))for(a=0;a<v;a++)x[a][o]=-x[a][o];break}for(p=A[s],c=(((g=A[o-1])-m)*(g+m)+((f=y[o-1])-(h=y[o]))*(f+h))/(2*h*g),f=Math.sqrt(c*c+1),c=((p-m)*(p+m)+h*(g/(c<0?c-f:c+f)-h))/p,M=s+(d=l=1);M<o+1;M++){if(f=y[M],g=A[M],h=d*f,f*=l,m=Math.sqrt(c*c+h*h),c=p*(l=c/(y[M-1]=m))+f*(d=h/m),f=-p*d+f*l,h=g*d,g*=l,n)for(a=0;a<v;a++)p=x[a][M-1],m=x[a][M],x[a][M-1]=p*l+m*d,x[a][M]=-p*d+m*l;if(m=Math.sqrt(c*c+h*h),c=(l=c/(A[M-1]=m))*f+(d=h/m)*g,p=-d*f+l*g,e)for(a=0;a<b;a++)g=w[a][M-1],m=w[a][M],w[a][M-1]=g*l+m*d,w[a][M]=-g*d+m*l}y[s]=0,y[o]=c,A[o]=p}for(M=0;M<v;M++)A[M]<r&&(A[M]=0);return{u:w,q:A,v:x}},t.VERSION="1.1.1",Object.defineProperty(t,"__esModule",{value:!0})}(e)}},e={};function n(r){var i=e[r];if(void 0!==i)return i.exports;var a=e[r]={exports:{}};return t[r].call(a.exports,a,a.exports,n),a.exports}n.d=(t,e)=>{for(var r in e)n.o(e,r)&&!n.o(t,r)&&Object.defineProperty(t,r,{enumerable:!0,get:e[r]})},n.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),n.r=t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})};var r={};(()=>{"use strict";n.r(r),n.d(r,{Langevitour:()=>ri});var t=n(162),e=n(409);function i(){}function a(t){return null==t?i:function(){return this.querySelector(t)}}function o(t){return null==t?[]:Array.isArray(t)?t:Array.from(t)}function s(){return[]}function u(t){return null==t?s:function(){return this.querySelectorAll(t)}}function l(t){return function(){return this.matches(t)}}function c(t){return function(e){return e.matches(t)}}var f=Array.prototype.find;function h(){return this.firstElementChild}var d=Array.prototype.filter;function p(){return Array.from(this.children)}function g(t){return new Array(t.length)}function m(t,e){this.ownerDocument=t.ownerDocument,this.namespaceURI=t.namespaceURI,this._next=null,this._parent=t,this.__data__=e}function v(t){return function(){return t}}function b(t,e,n,r,i,a){for(var o,s=0,u=e.length,l=a.length;s<l;++s)(o=e[s])?(o.__data__=a[s],r[s]=o):n[s]=new m(t,a[s]);for(;s<u;++s)(o=e[s])&&(i[s]=o)}function y(t,e,n,r,i,a,o){var s,u,l,c=new Map,f=e.length,h=a.length,d=new Array(f);for(s=0;s<f;++s)(u=e[s])&&(d[s]=l=o.call(u,u.__data__,s,e)+"",c.has(l)?i[s]=u:c.set(l,u));for(s=0;s<h;++s)l=o.call(t,a[s],s,a)+"",(u=c.get(l))?(r[s]=u,u.__data__=a[s],c.delete(l)):n[s]=new m(t,a[s]);for(s=0;s<f;++s)(u=e[s])&&c.get(d[s])===u&&(i[s]=u)}function w(t){return t.__data__}function x(t){return"object"==typeof t&&"length"in t?t:Array.from(t)}function _(t,e){return t<e?-1:t>e?1:t>=e?0:NaN}m.prototype={constructor:m,appendChild:function(t){return this._parent.insertBefore(t,this._next)},insertBefore:function(t,e){return this._parent.insertBefore(t,e)},querySelector:function(t){return this._parent.querySelector(t)},querySelectorAll:function(t){return this._parent.querySelectorAll(t)}};var M="http://www.w3.org/1999/xhtml";const k={svg:"http://www.w3.org/2000/svg",xhtml:M,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};function A(t){var e=t+="",n=e.indexOf(":");return n>=0&&"xmlns"!==(e=t.slice(0,n))&&(t=t.slice(n+1)),k.hasOwnProperty(e)?{space:k[e],local:t}:t}function S(t){return function(){this.removeAttribute(t)}}function N(t){return function(){this.removeAttributeNS(t.space,t.local)}}function q(t,e){return function(){this.setAttribute(t,e)}}function C(t,e){return function(){this.setAttributeNS(t.space,t.local,e)}}function E(t,e){return function(){var n=e.apply(this,arguments);null==n?this.removeAttribute(t):this.setAttribute(t,n)}}function I(t,e){return function(){var n=e.apply(this,arguments);null==n?this.removeAttributeNS(t.space,t.local):this.setAttributeNS(t.space,t.local,n)}}function j(t){return t.ownerDocument&&t.ownerDocument.defaultView||t.document&&t||t.defaultView}function P(t){return function(){this.style.removeProperty(t)}}function T(t,e,n){return function(){this.style.setProperty(t,e,n)}}function z(t,e,n){return function(){var r=e.apply(this,arguments);null==r?this.style.removeProperty(t):this.style.setProperty(t,r,n)}}function D(t,e){return t.style.getPropertyValue(e)||j(t).getComputedStyle(t,null).getPropertyValue(e)}function $(t){return function(){delete this[t]}}function B(t,e){return function(){this[t]=e}}function F(t,e){return function(){var n=e.apply(this,arguments);null==n?delete this[t]:this[t]=n}}function R(t){return t.trim().split(/^|\s+/)}function O(t){return t.classList||new L(t)}function L(t){this._node=t,this._names=R(t.getAttribute("class")||"")}function X(t,e){for(var n=O(t),r=-1,i=e.length;++r<i;)n.add(e[r])}function H(t,e){for(var n=O(t),r=-1,i=e.length;++r<i;)n.remove(e[r])}function Y(t){return function(){X(this,t)}}function U(t){return function(){H(this,t)}}function W(t,e){return function(){(e.apply(this,arguments)?X:H)(this,t)}}function V(){this.textContent=""}function G(t){return function(){this.textContent=t}}function K(t){return function(){var e=t.apply(this,arguments);this.textContent=null==e?"":e}}function J(){this.innerHTML=""}function Q(t){return function(){this.innerHTML=t}}function Z(t){return function(){var e=t.apply(this,arguments);this.innerHTML=null==e?"":e}}function tt(){this.nextSibling&&this.parentNode.appendChild(this)}function et(){this.previousSibling&&this.parentNode.insertBefore(this,this.parentNode.firstChild)}function nt(t){return function(){var e=this.ownerDocument,n=this.namespaceURI;return n===M&&e.documentElement.namespaceURI===M?e.createElement(t):e.createElementNS(n,t)}}function rt(t){return function(){return this.ownerDocument.createElementNS(t.space,t.local)}}function it(t){var e=A(t);return(e.local?rt:nt)(e)}function at(){return null}function ot(){var t=this.parentNode;t&&t.removeChild(this)}function st(){var t=this.cloneNode(!1),e=this.parentNode;return e?e.insertBefore(t,this.nextSibling):t}function ut(){var t=this.cloneNode(!0),e=this.parentNode;return e?e.insertBefore(t,this.nextSibling):t}function lt(t){return t.trim().split(/^|\s+/).map((function(t){var e="",n=t.indexOf(".");return n>=0&&(e=t.slice(n+1),t=t.slice(0,n)),{type:t,name:e}}))}function ct(t){return function(){var e=this.__on;if(e){for(var n,r=0,i=-1,a=e.length;r<a;++r)n=e[r],t.type&&n.type!==t.type||n.name!==t.name?e[++i]=n:this.removeEventListener(n.type,n.listener,n.options);++i?e.length=i:delete this.__on}}}function ft(t,e,n){return function(){var r,i=this.__on,a=function(t){return function(e){t.call(this,e,this.__data__)}}(e);if(i)for(var o=0,s=i.length;o<s;++o)if((r=i[o]).type===t.type&&r.name===t.name)return this.removeEventListener(r.type,r.listener,r.options),this.addEventListener(r.type,r.listener=a,r.options=n),void(r.value=e);this.addEventListener(t.type,a,n),r={type:t.type,name:t.name,value:e,listener:a,options:n},i?i.push(r):this.__on=[r]}}function ht(t,e,n){var r=j(t),i=r.CustomEvent;"function"==typeof i?i=new i(e,n):(i=r.document.createEvent("Event"),n?(i.initEvent(e,n.bubbles,n.cancelable),i.detail=n.detail):i.initEvent(e,!1,!1)),t.dispatchEvent(i)}function dt(t,e){return function(){return ht(this,t,e)}}function pt(t,e){return function(){return ht(this,t,e.apply(this,arguments))}}L.prototype={add:function(t){this._names.indexOf(t)<0&&(this._names.push(t),this._node.setAttribute("class",this._names.join(" ")))},remove:function(t){var e=this._names.indexOf(t);e>=0&&(this._names.splice(e,1),this._node.setAttribute("class",this._names.join(" ")))},contains:function(t){return this._names.indexOf(t)>=0}};var gt=[null];function mt(t,e){this._groups=t,this._parents=e}function vt(){return new mt([[document.documentElement]],gt)}mt.prototype=vt.prototype={constructor:mt,select:function(t){"function"!=typeof t&&(t=a(t));for(var e=this._groups,n=e.length,r=new Array(n),i=0;i<n;++i)for(var o,s,u=e[i],l=u.length,c=r[i]=new Array(l),f=0;f<l;++f)(o=u[f])&&(s=t.call(o,o.__data__,f,u))&&("__data__"in o&&(s.__data__=o.__data__),c[f]=s);return new mt(r,this._parents)},selectAll:function(t){t="function"==typeof t?function(t){return function(){return o(t.apply(this,arguments))}}(t):u(t);for(var e=this._groups,n=e.length,r=[],i=[],a=0;a<n;++a)for(var s,l=e[a],c=l.length,f=0;f<c;++f)(s=l[f])&&(r.push(t.call(s,s.__data__,f,l)),i.push(s));return new mt(r,i)},selectChild:function(t){return this.select(null==t?h:function(t){return function(){return f.call(this.children,t)}}("function"==typeof t?t:c(t)))},selectChildren:function(t){return this.selectAll(null==t?p:function(t){return function(){return d.call(this.children,t)}}("function"==typeof t?t:c(t)))},filter:function(t){"function"!=typeof t&&(t=l(t));for(var e=this._groups,n=e.length,r=new Array(n),i=0;i<n;++i)for(var a,o=e[i],s=o.length,u=r[i]=[],c=0;c<s;++c)(a=o[c])&&t.call(a,a.__data__,c,o)&&u.push(a);return new mt(r,this._parents)},data:function(t,e){if(!arguments.length)return Array.from(this,w);var n=e?y:b,r=this._parents,i=this._groups;"function"!=typeof t&&(t=v(t));for(var a=i.length,o=new Array(a),s=new Array(a),u=new Array(a),l=0;l<a;++l){var c=r[l],f=i[l],h=f.length,d=x(t.call(c,c&&c.__data__,l,r)),p=d.length,g=s[l]=new Array(p),m=o[l]=new Array(p),_=u[l]=new Array(h);n(c,f,g,m,_,d,e);for(var M,k,A=0,S=0;A<p;++A)if(M=g[A]){for(A>=S&&(S=A+1);!(k=m[S])&&++S<p;);M._next=k||null}}return(o=new mt(o,r))._enter=s,o._exit=u,o},enter:function(){return new mt(this._enter||this._groups.map(g),this._parents)},exit:function(){return new mt(this._exit||this._groups.map(g),this._parents)},join:function(t,e,n){var r=this.enter(),i=this,a=this.exit();return"function"==typeof t?(r=t(r))&&(r=r.selection()):r=r.append(t+""),null!=e&&(i=e(i))&&(i=i.selection()),null==n?a.remove():n(a),r&&i?r.merge(i).order():i},merge:function(t){for(var e=t.selection?t.selection():t,n=this._groups,r=e._groups,i=n.length,a=r.length,o=Math.min(i,a),s=new Array(i),u=0;u<o;++u)for(var l,c=n[u],f=r[u],h=c.length,d=s[u]=new Array(h),p=0;p<h;++p)(l=c[p]||f[p])&&(d[p]=l);for(;u<i;++u)s[u]=n[u];return new mt(s,this._parents)},selection:function(){return this},order:function(){for(var t=this._groups,e=-1,n=t.length;++e<n;)for(var r,i=t[e],a=i.length-1,o=i[a];--a>=0;)(r=i[a])&&(o&&4^r.compareDocumentPosition(o)&&o.parentNode.insertBefore(r,o),o=r);return this},sort:function(t){function e(e,n){return e&&n?t(e.__data__,n.__data__):!e-!n}t||(t=_);for(var n=this._groups,r=n.length,i=new Array(r),a=0;a<r;++a){for(var o,s=n[a],u=s.length,l=i[a]=new Array(u),c=0;c<u;++c)(o=s[c])&&(l[c]=o);l.sort(e)}return new mt(i,this._parents).order()},call:function(){var t=arguments[0];return arguments[0]=this,t.apply(null,arguments),this},nodes:function(){return Array.from(this)},node:function(){for(var t=this._groups,e=0,n=t.length;e<n;++e)for(var r=t[e],i=0,a=r.length;i<a;++i){var o=r[i];if(o)return o}return null},size:function(){let t=0;for(const e of this)++t;return t},empty:function(){return!this.node()},each:function(t){for(var e=this._groups,n=0,r=e.length;n<r;++n)for(var i,a=e[n],o=0,s=a.length;o<s;++o)(i=a[o])&&t.call(i,i.__data__,o,a);return this},attr:function(t,e){var n=A(t);if(arguments.length<2){var r=this.node();return n.local?r.getAttributeNS(n.space,n.local):r.getAttribute(n)}return this.each((null==e?n.local?N:S:"function"==typeof e?n.local?I:E:n.local?C:q)(n,e))},style:function(t,e,n){return arguments.length>1?this.each((null==e?P:"function"==typeof e?z:T)(t,e,null==n?"":n)):D(this.node(),t)},property:function(t,e){return arguments.length>1?this.each((null==e?$:"function"==typeof e?F:B)(t,e)):this.node()[t]},classed:function(t,e){var n=R(t+"");if(arguments.length<2){for(var r=O(this.node()),i=-1,a=n.length;++i<a;)if(!r.contains(n[i]))return!1;return!0}return this.each(("function"==typeof e?W:e?Y:U)(n,e))},text:function(t){return arguments.length?this.each(null==t?V:("function"==typeof t?K:G)(t)):this.node().textContent},html:function(t){return arguments.length?this.each(null==t?J:("function"==typeof t?Z:Q)(t)):this.node().innerHTML},raise:function(){return this.each(tt)},lower:function(){return this.each(et)},append:function(t){var e="function"==typeof t?t:it(t);return this.select((function(){return this.appendChild(e.apply(this,arguments))}))},insert:function(t,e){var n="function"==typeof t?t:it(t),r=null==e?at:"function"==typeof e?e:a(e);return this.select((function(){return this.insertBefore(n.apply(this,arguments),r.apply(this,arguments)||null)}))},remove:function(){return this.each(ot)},clone:function(t){return this.select(t?ut:st)},datum:function(t){return arguments.length?this.property("__data__",t):this.node().__data__},on:function(t,e,n){var r,i,a=lt(t+""),o=a.length;if(!(arguments.length<2)){for(s=e?ft:ct,r=0;r<o;++r)this.each(s(a[r],e,n));return this}var s=this.node().__on;if(s)for(var u,l=0,c=s.length;l<c;++l)for(r=0,u=s[l];r<o;++r)if((i=a[r]).type===u.type&&i.name===u.name)return u.value},dispatch:function(t,e){return this.each(("function"==typeof e?pt:dt)(t,e))},[Symbol.iterator]:function*(){for(var t=this._groups,e=0,n=t.length;e<n;++e)for(var r,i=t[e],a=0,o=i.length;a<o;++a)(r=i[a])&&(yield r)}};const bt=vt;var yt={value:()=>{}};function wt(){for(var t,e=0,n=arguments.length,r={};e<n;++e){if(!(t=arguments[e]+"")||t in r||/[\s.]/.test(t))throw new Error("illegal type: "+t);r[t]=[]}return new xt(r)}function xt(t){this._=t}function _t(t,e){return t.trim().split(/^|\s+/).map((function(t){var n="",r=t.indexOf(".");if(r>=0&&(n=t.slice(r+1),t=t.slice(0,r)),t&&!e.hasOwnProperty(t))throw new Error("unknown type: "+t);return{type:t,name:n}}))}function Mt(t,e){for(var n,r=0,i=t.length;r<i;++r)if((n=t[r]).name===e)return n.value}function kt(t,e,n){for(var r=0,i=t.length;r<i;++r)if(t[r].name===e){t[r]=yt,t=t.slice(0,r).concat(t.slice(r+1));break}return null!=n&&t.push({name:e,value:n}),t}xt.prototype=wt.prototype={constructor:xt,on:function(t,e){var n,r=this._,i=_t(t+"",r),a=-1,o=i.length;if(!(arguments.length<2)){if(null!=e&&"function"!=typeof e)throw new Error("invalid callback: "+e);for(;++a<o;)if(n=(t=i[a]).type)r[n]=kt(r[n],t.name,e);else if(null==e)for(n in r)r[n]=kt(r[n],t.name,null);return this}for(;++a<o;)if((n=(t=i[a]).type)&&(n=Mt(r[n],t.name)))return n},copy:function(){var t={},e=this._;for(var n in e)t[n]=e[n].slice();return new xt(t)},call:function(t,e){if((n=arguments.length-2)>0)for(var n,r,i=new Array(n),a=0;a<n;++a)i[a]=arguments[a+2];if(!this._.hasOwnProperty(t))throw new Error("unknown type: "+t);for(a=0,n=(r=this._[t]).length;a<n;++a)r[a].value.apply(e,i)},apply:function(t,e,n){if(!this._.hasOwnProperty(t))throw new Error("unknown type: "+t);for(var r=this._[t],i=0,a=r.length;i<a;++i)r[i].value.apply(e,n)}};const At=wt;var St,Nt,qt=0,Ct=0,Et=0,It=0,jt=0,Pt=0,Tt="object"==typeof performance&&performance.now?performance:Date,zt="object"==typeof window&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(t){setTimeout(t,17)};function Dt(){return jt||(zt($t),jt=Tt.now()+Pt)}function $t(){jt=0}function Bt(){this._call=this._time=this._next=null}function Ft(t,e,n){var r=new Bt;return r.restart(t,e,n),r}function Rt(){jt=(It=Tt.now())+Pt,qt=Ct=0;try{!function(){Dt(),++qt;for(var t,e=St;e;)(t=jt-e._time)>=0&&e._call.call(void 0,t),e=e._next;--qt}()}finally{qt=0,function(){for(var t,e,n=St,r=1/0;n;)n._call?(r>n._time&&(r=n._time),t=n,n=n._next):(e=n._next,n._next=null,n=t?t._next=e:St=e);Nt=t,Lt(r)}(),jt=0}}function Ot(){var t=Tt.now(),e=t-It;e>1e3&&(Pt-=e,It=t)}function Lt(t){qt||(Ct&&(Ct=clearTimeout(Ct)),t-jt>24?(t<1/0&&(Ct=setTimeout(Rt,t-Tt.now()-Pt)),Et&&(Et=clearInterval(Et))):(Et||(It=Tt.now(),Et=setInterval(Ot,1e3)),qt=1,zt(Rt)))}function Xt(t,e,n){var r=new Bt;return e=null==e?0:+e,r.restart((n=>{r.stop(),t(n+e)}),e,n),r}Bt.prototype=Ft.prototype={constructor:Bt,restart:function(t,e,n){if("function"!=typeof t)throw new TypeError("callback is not a function");n=(null==n?Dt():+n)+(null==e?0:+e),this._next||Nt===this||(Nt?Nt._next=this:St=this,Nt=this),this._call=t,this._time=n,Lt()},stop:function(){this._call&&(this._call=null,this._time=1/0,Lt())}};var Ht=At("start","end","cancel","interrupt"),Yt=[];function Ut(t,e,n,r,i,a){var o=t.__transition;if(o){if(n in o)return}else t.__transition={};!function(t,e,n){var r,i=t.__transition;function a(u){var l,c,f,h;if(1!==n.state)return s();for(l in i)if((h=i[l]).name===n.name){if(3===h.state)return Xt(a);4===h.state?(h.state=6,h.timer.stop(),h.on.call("interrupt",t,t.__data__,h.index,h.group),delete i[l]):+l<e&&(h.state=6,h.timer.stop(),h.on.call("cancel",t,t.__data__,h.index,h.group),delete i[l])}if(Xt((function(){3===n.state&&(n.state=4,n.timer.restart(o,n.delay,n.time),o(u))})),n.state=2,n.on.call("start",t,t.__data__,n.index,n.group),2===n.state){for(n.state=3,r=new Array(f=n.tween.length),l=0,c=-1;l<f;++l)(h=n.tween[l].value.call(t,t.__data__,n.index,n.group))&&(r[++c]=h);r.length=c+1}}function o(e){for(var i=e<n.duration?n.ease.call(null,e/n.duration):(n.timer.restart(s),n.state=5,1),a=-1,o=r.length;++a<o;)r[a].call(t,i);5===n.state&&(n.on.call("end",t,t.__data__,n.index,n.group),s())}function s(){for(var r in n.state=6,n.timer.stop(),delete i[e],i)return;delete t.__transition}i[e]=n,n.timer=Ft((function(t){n.state=1,n.timer.restart(a,n.delay,n.time),n.delay<=t&&a(t-n.delay)}),0,n.time)}(t,n,{name:e,index:r,group:i,on:Ht,tween:Yt,time:a.time,delay:a.delay,duration:a.duration,ease:a.ease,timer:null,state:0})}function Wt(t,e){var n=Gt(t,e);if(n.state>0)throw new Error("too late; already scheduled");return n}function Vt(t,e){var n=Gt(t,e);if(n.state>3)throw new Error("too late; already running");return n}function Gt(t,e){var n=t.__transition;if(!n||!(n=n[e]))throw new Error("transition not found");return n}function Kt(t,e){return t=+t,e=+e,function(n){return t*(1-n)+e*n}}var Jt,Qt=180/Math.PI,Zt={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1};function te(t,e,n,r,i,a){var o,s,u;return(o=Math.sqrt(t*t+e*e))&&(t/=o,e/=o),(u=t*n+e*r)&&(n-=t*u,r-=e*u),(s=Math.sqrt(n*n+r*r))&&(n/=s,r/=s,u/=s),t*r<e*n&&(t=-t,e=-e,u=-u,o=-o),{translateX:i,translateY:a,rotate:Math.atan2(e,t)*Qt,skewX:Math.atan(u)*Qt,scaleX:o,scaleY:s}}function ee(t,e,n,r){function i(t){return t.length?t.pop()+" ":""}return function(a,o){var s=[],u=[];return a=t(a),o=t(o),function(t,r,i,a,o,s){if(t!==i||r!==a){var u=o.push("translate(",null,e,null,n);s.push({i:u-4,x:Kt(t,i)},{i:u-2,x:Kt(r,a)})}else(i||a)&&o.push("translate("+i+e+a+n)}(a.translateX,a.translateY,o.translateX,o.translateY,s,u),function(t,e,n,a){t!==e?(t-e>180?e+=360:e-t>180&&(t+=360),a.push({i:n.push(i(n)+"rotate(",null,r)-2,x:Kt(t,e)})):e&&n.push(i(n)+"rotate("+e+r)}(a.rotate,o.rotate,s,u),function(t,e,n,a){t!==e?a.push({i:n.push(i(n)+"skewX(",null,r)-2,x:Kt(t,e)}):e&&n.push(i(n)+"skewX("+e+r)}(a.skewX,o.skewX,s,u),function(t,e,n,r,a,o){if(t!==n||e!==r){var s=a.push(i(a)+"scale(",null,",",null,")");o.push({i:s-4,x:Kt(t,n)},{i:s-2,x:Kt(e,r)})}else 1===n&&1===r||a.push(i(a)+"scale("+n+","+r+")")}(a.scaleX,a.scaleY,o.scaleX,o.scaleY,s,u),a=o=null,function(t){for(var e,n=-1,r=u.length;++n<r;)s[(e=u[n]).i]=e.x(t);return s.join("")}}}var ne=ee((function(t){const e=new("function"==typeof DOMMatrix?DOMMatrix:WebKitCSSMatrix)(t+"");return e.isIdentity?Zt:te(e.a,e.b,e.c,e.d,e.e,e.f)}),"px, ","px)","deg)"),re=ee((function(t){return null==t?Zt:(Jt||(Jt=document.createElementNS("http://www.w3.org/2000/svg","g")),Jt.setAttribute("transform",t),(t=Jt.transform.baseVal.consolidate())?te((t=t.matrix).a,t.b,t.c,t.d,t.e,t.f):Zt)}),", ",")",")");function ie(t,e){var n,r;return function(){var i=Vt(this,t),a=i.tween;if(a!==n)for(var o=0,s=(r=n=a).length;o<s;++o)if(r[o].name===e){(r=r.slice()).splice(o,1);break}i.tween=r}}function ae(t,e,n){var r,i;if("function"!=typeof n)throw new Error;return function(){var a=Vt(this,t),o=a.tween;if(o!==r){i=(r=o).slice();for(var s={name:e,value:n},u=0,l=i.length;u<l;++u)if(i[u].name===e){i[u]=s;break}u===l&&i.push(s)}a.tween=i}}function oe(t,e,n){var r=t._id;return t.each((function(){var t=Vt(this,r);(t.value||(t.value={}))[e]=n.apply(this,arguments)})),function(t){return Gt(t,r).value[e]}}function se(t,e,n){t.prototype=e.prototype=n,n.constructor=t}function ue(t,e){var n=Object.create(t.prototype);for(var r in e)n[r]=e[r];return n}function le(){}var ce=.7,fe=1/ce,he="\\s*([+-]?\\d+)\\s*",de="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",pe="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",ge=/^#([0-9a-f]{3,8})$/,me=new RegExp(`^rgb\\(${he},${he},${he}\\)$`),ve=new RegExp(`^rgb\\(${pe},${pe},${pe}\\)$`),be=new RegExp(`^rgba\\(${he},${he},${he},${de}\\)$`),ye=new RegExp(`^rgba\\(${pe},${pe},${pe},${de}\\)$`),we=new RegExp(`^hsl\\(${de},${pe},${pe}\\)$`),xe=new RegExp(`^hsla\\(${de},${pe},${pe},${de}\\)$`),_e={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};function Me(){return this.rgb().formatHex()}function ke(){return this.rgb().formatRgb()}function Ae(t){var e,n;return t=(t+"").trim().toLowerCase(),(e=ge.exec(t))?(n=e[1].length,e=parseInt(e[1],16),6===n?Se(e):3===n?new Ee(e>>8&15|e>>4&240,e>>4&15|240&e,(15&e)<<4|15&e,1):8===n?Ne(e>>24&255,e>>16&255,e>>8&255,(255&e)/255):4===n?Ne(e>>12&15|e>>8&240,e>>8&15|e>>4&240,e>>4&15|240&e,((15&e)<<4|15&e)/255):null):(e=me.exec(t))?new Ee(e[1],e[2],e[3],1):(e=ve.exec(t))?new Ee(255*e[1]/100,255*e[2]/100,255*e[3]/100,1):(e=be.exec(t))?Ne(e[1],e[2],e[3],e[4]):(e=ye.exec(t))?Ne(255*e[1]/100,255*e[2]/100,255*e[3]/100,e[4]):(e=we.exec(t))?De(e[1],e[2]/100,e[3]/100,1):(e=xe.exec(t))?De(e[1],e[2]/100,e[3]/100,e[4]):_e.hasOwnProperty(t)?Se(_e[t]):"transparent"===t?new Ee(NaN,NaN,NaN,0):null}function Se(t){return new Ee(t>>16&255,t>>8&255,255&t,1)}function Ne(t,e,n,r){return r<=0&&(t=e=n=NaN),new Ee(t,e,n,r)}function qe(t){return t instanceof le||(t=Ae(t)),t?new Ee((t=t.rgb()).r,t.g,t.b,t.opacity):new Ee}function Ce(t,e,n,r){return 1===arguments.length?qe(t):new Ee(t,e,n,null==r?1:r)}function Ee(t,e,n,r){this.r=+t,this.g=+e,this.b=+n,this.opacity=+r}function Ie(){return`#${ze(this.r)}${ze(this.g)}${ze(this.b)}`}function je(){const t=Pe(this.opacity);return`${1===t?"rgb(":"rgba("}${Te(this.r)}, ${Te(this.g)}, ${Te(this.b)}${1===t?")":`, ${t})`}`}function Pe(t){return isNaN(t)?1:Math.max(0,Math.min(1,t))}function Te(t){return Math.max(0,Math.min(255,Math.round(t)||0))}function ze(t){return((t=Te(t))<16?"0":"")+t.toString(16)}function De(t,e,n,r){return r<=0?t=e=n=NaN:n<=0||n>=1?t=e=NaN:e<=0&&(t=NaN),new Be(t,e,n,r)}function $e(t){if(t instanceof Be)return new Be(t.h,t.s,t.l,t.opacity);if(t instanceof le||(t=Ae(t)),!t)return new Be;if(t instanceof Be)return t;var e=(t=t.rgb()).r/255,n=t.g/255,r=t.b/255,i=Math.min(e,n,r),a=Math.max(e,n,r),o=NaN,s=a-i,u=(a+i)/2;return s?(o=e===a?(n-r)/s+6*(n<r):n===a?(r-e)/s+2:(e-n)/s+4,s/=u<.5?a+i:2-a-i,o*=60):s=u>0&&u<1?0:o,new Be(o,s,u,t.opacity)}function Be(t,e,n,r){this.h=+t,this.s=+e,this.l=+n,this.opacity=+r}function Fe(t){return(t=(t||0)%360)<0?t+360:t}function Re(t){return Math.max(0,Math.min(1,t||0))}function Oe(t,e,n){return 255*(t<60?e+(n-e)*t/60:t<180?n:t<240?e+(n-e)*(240-t)/60:e)}function Le(t,e,n,r,i){var a=t*t,o=a*t;return((1-3*t+3*a-o)*e+(4-6*a+3*o)*n+(1+3*t+3*a-3*o)*r+o*i)/6}se(le,Ae,{copy(t){return Object.assign(new this.constructor,this,t)},displayable(){return this.rgb().displayable()},hex:Me,formatHex:Me,formatHex8:function(){return this.rgb().formatHex8()},formatHsl:function(){return $e(this).formatHsl()},formatRgb:ke,toString:ke}),se(Ee,Ce,ue(le,{brighter(t){return t=null==t?fe:Math.pow(fe,t),new Ee(this.r*t,this.g*t,this.b*t,this.opacity)},darker(t){return t=null==t?ce:Math.pow(ce,t),new Ee(this.r*t,this.g*t,this.b*t,this.opacity)},rgb(){return this},clamp(){return new Ee(Te(this.r),Te(this.g),Te(this.b),Pe(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:Ie,formatHex:Ie,formatHex8:function(){return`#${ze(this.r)}${ze(this.g)}${ze(this.b)}${ze(255*(isNaN(this.opacity)?1:this.opacity))}`},formatRgb:je,toString:je})),se(Be,(function(t,e,n,r){return 1===arguments.length?$e(t):new Be(t,e,n,null==r?1:r)}),ue(le,{brighter(t){return t=null==t?fe:Math.pow(fe,t),new Be(this.h,this.s,this.l*t,this.opacity)},darker(t){return t=null==t?ce:Math.pow(ce,t),new Be(this.h,this.s,this.l*t,this.opacity)},rgb(){var t=this.h%360+360*(this.h<0),e=isNaN(t)||isNaN(this.s)?0:this.s,n=this.l,r=n+(n<.5?n:1-n)*e,i=2*n-r;return new Ee(Oe(t>=240?t-240:t+120,i,r),Oe(t,i,r),Oe(t<120?t+240:t-120,i,r),this.opacity)},clamp(){return new Be(Fe(this.h),Re(this.s),Re(this.l),Pe(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const t=Pe(this.opacity);return`${1===t?"hsl(":"hsla("}${Fe(this.h)}, ${100*Re(this.s)}%, ${100*Re(this.l)}%${1===t?")":`, ${t})`}`}}));const Xe=t=>()=>t;function He(t,e){var n=e-t;return n?function(t,e){return function(n){return t+n*e}}(t,n):Xe(isNaN(t)?e:t)}const Ye=function t(e){var n=function(t){return 1==(t=+t)?He:function(e,n){return n-e?function(t,e,n){return t=Math.pow(t,n),e=Math.pow(e,n)-t,n=1/n,function(r){return Math.pow(t+r*e,n)}}(e,n,t):Xe(isNaN(e)?n:e)}}(e);function r(t,e){var r=n((t=Ce(t)).r,(e=Ce(e)).r),i=n(t.g,e.g),a=n(t.b,e.b),o=He(t.opacity,e.opacity);return function(e){return t.r=r(e),t.g=i(e),t.b=a(e),t.opacity=o(e),t+""}}return r.gamma=t,r}(1);function Ue(t){return function(e){var n,r,i=e.length,a=new Array(i),o=new Array(i),s=new Array(i);for(n=0;n<i;++n)r=Ce(e[n]),a[n]=r.r||0,o[n]=r.g||0,s[n]=r.b||0;return a=t(a),o=t(o),s=t(s),r.opacity=1,function(t){return r.r=a(t),r.g=o(t),r.b=s(t),r+""}}}Ue((function(t){var e=t.length-1;return function(n){var r=n<=0?n=0:n>=1?(n=1,e-1):Math.floor(n*e),i=t[r],a=t[r+1],o=r>0?t[r-1]:2*i-a,s=r<e-1?t[r+2]:2*a-i;return Le((n-r/e)*e,o,i,a,s)}})),Ue((function(t){var e=t.length;return function(n){var r=Math.floor(((n%=1)<0?++n:n)*e),i=t[(r+e-1)%e],a=t[r%e],o=t[(r+1)%e],s=t[(r+2)%e];return Le((n-r/e)*e,i,a,o,s)}}));var We=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,Ve=new RegExp(We.source,"g");function Ge(t,e){var n,r,i,a=We.lastIndex=Ve.lastIndex=0,o=-1,s=[],u=[];for(t+="",e+="";(n=We.exec(t))&&(r=Ve.exec(e));)(i=r.index)>a&&(i=e.slice(a,i),s[o]?s[o]+=i:s[++o]=i),(n=n[0])===(r=r[0])?s[o]?s[o]+=r:s[++o]=r:(s[++o]=null,u.push({i:o,x:Kt(n,r)})),a=Ve.lastIndex;return a<e.length&&(i=e.slice(a),s[o]?s[o]+=i:s[++o]=i),s.length<2?u[0]?function(t){return function(e){return t(e)+""}}(u[0].x):function(t){return function(){return t}}(e):(e=u.length,function(t){for(var n,r=0;r<e;++r)s[(n=u[r]).i]=n.x(t);return s.join("")})}function Ke(t,e){var n;return("number"==typeof e?Kt:e instanceof Ae?Ye:(n=Ae(e))?(e=n,Ye):Ge)(t,e)}function Je(t){return function(){this.removeAttribute(t)}}function Qe(t){return function(){this.removeAttributeNS(t.space,t.local)}}function Ze(t,e,n){var r,i,a=n+"";return function(){var o=this.getAttribute(t);return o===a?null:o===r?i:i=e(r=o,n)}}function tn(t,e,n){var r,i,a=n+"";return function(){var o=this.getAttributeNS(t.space,t.local);return o===a?null:o===r?i:i=e(r=o,n)}}function en(t,e,n){var r,i,a;return function(){var o,s,u=n(this);if(null!=u)return(o=this.getAttribute(t))===(s=u+"")?null:o===r&&s===i?a:(i=s,a=e(r=o,u));this.removeAttribute(t)}}function nn(t,e,n){var r,i,a;return function(){var o,s,u=n(this);if(null!=u)return(o=this.getAttributeNS(t.space,t.local))===(s=u+"")?null:o===r&&s===i?a:(i=s,a=e(r=o,u));this.removeAttributeNS(t.space,t.local)}}function rn(t,e){return function(n){this.setAttribute(t,e.call(this,n))}}function an(t,e){return function(n){this.setAttributeNS(t.space,t.local,e.call(this,n))}}function on(t,e){var n,r;function i(){var i=e.apply(this,arguments);return i!==r&&(n=(r=i)&&an(t,i)),n}return i._value=e,i}function sn(t,e){var n,r;function i(){var i=e.apply(this,arguments);return i!==r&&(n=(r=i)&&rn(t,i)),n}return i._value=e,i}function un(t,e){return function(){Wt(this,t).delay=+e.apply(this,arguments)}}function ln(t,e){return e=+e,function(){Wt(this,t).delay=e}}function cn(t,e){return function(){Vt(this,t).duration=+e.apply(this,arguments)}}function fn(t,e){return e=+e,function(){Vt(this,t).duration=e}}function hn(t,e){if("function"!=typeof e)throw new Error;return function(){Vt(this,t).ease=e}}function dn(t,e,n){var r,i,a=function(t){return(t+"").trim().split(/^|\s+/).every((function(t){var e=t.indexOf(".");return e>=0&&(t=t.slice(0,e)),!t||"start"===t}))}(e)?Wt:Vt;return function(){var o=a(this,t),s=o.on;s!==r&&(i=(r=s).copy()).on(e,n),o.on=i}}var pn=bt.prototype.constructor;function gn(t){return function(){this.style.removeProperty(t)}}function mn(t,e,n){return function(r){this.style.setProperty(t,e.call(this,r),n)}}function vn(t,e,n){var r,i;function a(){var a=e.apply(this,arguments);return a!==i&&(r=(i=a)&&mn(t,a,n)),r}return a._value=e,a}function bn(t){return function(e){this.textContent=t.call(this,e)}}function yn(t){var e,n;function r(){var r=t.apply(this,arguments);return r!==n&&(e=(n=r)&&bn(r)),e}return r._value=t,r}var wn=0;function xn(t,e,n,r){this._groups=t,this._parents=e,this._name=n,this._id=r}function _n(){return++wn}var Mn=bt.prototype;xn.prototype=function(t){return bt().transition(t)}.prototype={constructor:xn,select:function(t){var e=this._name,n=this._id;"function"!=typeof t&&(t=a(t));for(var r=this._groups,i=r.length,o=new Array(i),s=0;s<i;++s)for(var u,l,c=r[s],f=c.length,h=o[s]=new Array(f),d=0;d<f;++d)(u=c[d])&&(l=t.call(u,u.__data__,d,c))&&("__data__"in u&&(l.__data__=u.__data__),h[d]=l,Ut(h[d],e,n,d,h,Gt(u,n)));return new xn(o,this._parents,e,n)},selectAll:function(t){var e=this._name,n=this._id;"function"!=typeof t&&(t=u(t));for(var r=this._groups,i=r.length,a=[],o=[],s=0;s<i;++s)for(var l,c=r[s],f=c.length,h=0;h<f;++h)if(l=c[h]){for(var d,p=t.call(l,l.__data__,h,c),g=Gt(l,n),m=0,v=p.length;m<v;++m)(d=p[m])&&Ut(d,e,n,m,p,g);a.push(p),o.push(l)}return new xn(a,o,e,n)},selectChild:Mn.selectChild,selectChildren:Mn.selectChildren,filter:function(t){"function"!=typeof t&&(t=l(t));for(var e=this._groups,n=e.length,r=new Array(n),i=0;i<n;++i)for(var a,o=e[i],s=o.length,u=r[i]=[],c=0;c<s;++c)(a=o[c])&&t.call(a,a.__data__,c,o)&&u.push(a);return new xn(r,this._parents,this._name,this._id)},merge:function(t){if(t._id!==this._id)throw new Error;for(var e=this._groups,n=t._groups,r=e.length,i=n.length,a=Math.min(r,i),o=new Array(r),s=0;s<a;++s)for(var u,l=e[s],c=n[s],f=l.length,h=o[s]=new Array(f),d=0;d<f;++d)(u=l[d]||c[d])&&(h[d]=u);for(;s<r;++s)o[s]=e[s];return new xn(o,this._parents,this._name,this._id)},selection:function(){return new pn(this._groups,this._parents)},transition:function(){for(var t=this._name,e=this._id,n=_n(),r=this._groups,i=r.length,a=0;a<i;++a)for(var o,s=r[a],u=s.length,l=0;l<u;++l)if(o=s[l]){var c=Gt(o,e);Ut(o,t,n,l,s,{time:c.time+c.delay+c.duration,delay:0,duration:c.duration,ease:c.ease})}return new xn(r,this._parents,t,n)},call:Mn.call,nodes:Mn.nodes,node:Mn.node,size:Mn.size,empty:Mn.empty,each:Mn.each,on:function(t,e){var n=this._id;return arguments.length<2?Gt(this.node(),n).on.on(t):this.each(dn(n,t,e))},attr:function(t,e){var n=A(t),r="transform"===n?re:Ke;return this.attrTween(t,"function"==typeof e?(n.local?nn:en)(n,r,oe(this,"attr."+t,e)):null==e?(n.local?Qe:Je)(n):(n.local?tn:Ze)(n,r,e))},attrTween:function(t,e){var n="attr."+t;if(arguments.length<2)return(n=this.tween(n))&&n._value;if(null==e)return this.tween(n,null);if("function"!=typeof e)throw new Error;var r=A(t);return this.tween(n,(r.local?on:sn)(r,e))},style:function(t,e,n){var r="transform"==(t+="")?ne:Ke;return null==e?this.styleTween(t,function(t,e){var n,r,i;return function(){var a=D(this,t),o=(this.style.removeProperty(t),D(this,t));return a===o?null:a===n&&o===r?i:i=e(n=a,r=o)}}(t,r)).on("end.style."+t,gn(t)):"function"==typeof e?this.styleTween(t,function(t,e,n){var r,i,a;return function(){var o=D(this,t),s=n(this),u=s+"";return null==s&&(this.style.removeProperty(t),u=s=D(this,t)),o===u?null:o===r&&u===i?a:(i=u,a=e(r=o,s))}}(t,r,oe(this,"style."+t,e))).each(function(t,e){var n,r,i,a,o="style."+e,s="end."+o;return function(){var u=Vt(this,t),l=u.on,c=null==u.value[o]?a||(a=gn(e)):void 0;l===n&&i===c||(r=(n=l).copy()).on(s,i=c),u.on=r}}(this._id,t)):this.styleTween(t,function(t,e,n){var r,i,a=n+"";return function(){var o=D(this,t);return o===a?null:o===r?i:i=e(r=o,n)}}(t,r,e),n).on("end.style."+t,null)},styleTween:function(t,e,n){var r="style."+(t+="");if(arguments.length<2)return(r=this.tween(r))&&r._value;if(null==e)return this.tween(r,null);if("function"!=typeof e)throw new Error;return this.tween(r,vn(t,e,null==n?"":n))},text:function(t){return this.tween("text","function"==typeof t?function(t){return function(){var e=t(this);this.textContent=null==e?"":e}}(oe(this,"text",t)):function(t){return function(){this.textContent=t}}(null==t?"":t+""))},textTween:function(t){var e="text";if(arguments.length<1)return(e=this.tween(e))&&e._value;if(null==t)return this.tween(e,null);if("function"!=typeof t)throw new Error;return this.tween(e,yn(t))},remove:function(){return this.on("end.remove",function(t){return function(){var e=this.parentNode;for(var n in this.__transition)if(+n!==t)return;e&&e.removeChild(this)}}(this._id))},tween:function(t,e){var n=this._id;if(t+="",arguments.length<2){for(var r,i=Gt(this.node(),n).tween,a=0,o=i.length;a<o;++a)if((r=i[a]).name===t)return r.value;return null}return this.each((null==e?ie:ae)(n,t,e))},delay:function(t){var e=this._id;return arguments.length?this.each(("function"==typeof t?un:ln)(e,t)):Gt(this.node(),e).delay},duration:function(t){var e=this._id;return arguments.length?this.each(("function"==typeof t?cn:fn)(e,t)):Gt(this.node(),e).duration},ease:function(t){var e=this._id;return arguments.length?this.each(hn(e,t)):Gt(this.node(),e).ease},easeVarying:function(t){if("function"!=typeof t)throw new Error;return this.each(function(t,e){return function(){var n=e.apply(this,arguments);if("function"!=typeof n)throw new Error;Vt(this,t).ease=n}}(this._id,t))},end:function(){var t,e,n=this,r=n._id,i=n.size();return new Promise((function(a,o){var s={value:o},u={value:function(){0==--i&&a()}};n.each((function(){var n=Vt(this,r),i=n.on;i!==t&&((e=(t=i).copy())._.cancel.push(s),e._.interrupt.push(s),e._.end.push(u)),n.on=e})),0===i&&a()}))},[Symbol.iterator]:Mn[Symbol.iterator]};var kn={time:null,delay:0,duration:250,ease:function(t){return((t*=2)<=1?t*t*t:(t-=2)*t*t+2)/2}};function An(t,e){for(var n;!(n=t.__transition)||!(n=n[e]);)if(!(t=t.parentNode))throw new Error(`transition ${e} not found`);return n}bt.prototype.interrupt=function(t){return this.each((function(){!function(t,e){var n,r,i,a=t.__transition,o=!0;if(a){for(i in e=null==e?null:e+"",a)(n=a[i]).name===e?(r=n.state>2&&n.state<5,n.state=6,n.timer.stop(),n.on.call(r?"interrupt":"cancel",t,t.__data__,n.index,n.group),delete a[i]):o=!1;o&&delete t.__transition}}(this,t)}))},bt.prototype.transition=function(t){var e,n;t instanceof xn?(e=t._id,t=t._name):(e=_n(),(n=kn).time=Dt(),t=null==t?null:t+"");for(var r=this._groups,i=r.length,a=0;a<i;++a)for(var o,s=r[a],u=s.length,l=0;l<u;++l)(o=s[l])&&Ut(o,t,e,l,s,n||An(o,e));return new xn(r,this._parents,t,e)};const{abs:Sn,max:Nn,min:qn}=Math;function Cn(t){return{type:t}}function En(t){return"string"==typeof t?new mt([[document.querySelector(t)]],[document.documentElement]):new mt([[t]],gt)}function In(t,e){if(t=function(t){let e;for(;e=t.sourceEvent;)t=e;return t}(t),void 0===e&&(e=t.currentTarget),e){var n=e.ownerSVGElement||e;if(n.createSVGPoint){var r=n.createSVGPoint();return r.x=t.clientX,r.y=t.clientY,[(r=r.matrixTransform(e.getScreenCTM().inverse())).x,r.y]}if(e.getBoundingClientRect){var i=e.getBoundingClientRect();return[t.clientX-i.left-e.clientLeft,t.clientY-i.top-e.clientTop]}}return[t.pageX,t.pageY]}["w","e"].map(Cn),["n","s"].map(Cn),["n","w","e","s","nw","ne","sw","se"].map(Cn);const jn={passive:!1},Pn={capture:!0,passive:!1};function Tn(t){t.stopImmediatePropagation()}function zn(t){t.preventDefault(),t.stopImmediatePropagation()}const Dn=t=>()=>t;function $n(t,{sourceEvent:e,subject:n,target:r,identifier:i,active:a,x:o,y:s,dx:u,dy:l,dispatch:c}){Object.defineProperties(this,{type:{value:t,enumerable:!0,configurable:!0},sourceEvent:{value:e,enumerable:!0,configurable:!0},subject:{value:n,enumerable:!0,configurable:!0},target:{value:r,enumerable:!0,configurable:!0},identifier:{value:i,enumerable:!0,configurable:!0},active:{value:a,enumerable:!0,configurable:!0},x:{value:o,enumerable:!0,configurable:!0},y:{value:s,enumerable:!0,configurable:!0},dx:{value:u,enumerable:!0,configurable:!0},dy:{value:l,enumerable:!0,configurable:!0},_:{value:c}})}function Bn(t){return!t.ctrlKey&&!t.button}function Fn(){return this.parentNode}function Rn(t,e){return null==e?{x:t.x,y:t.y}:e}function On(){return navigator.maxTouchPoints||"ontouchstart"in this}$n.prototype.on=function(){var t=this._.on.apply(this._,arguments);return t===this._?this:t};var Ln=Math.sqrt(50),Xn=Math.sqrt(10),Hn=Math.sqrt(2);function Yn(t,e,n){var r=(e-t)/Math.max(0,n),i=Math.floor(Math.log(r)/Math.LN10),a=r/Math.pow(10,i);return i>=0?(a>=Ln?10:a>=Xn?5:a>=Hn?2:1)*Math.pow(10,i):-Math.pow(10,-i)/(a>=Ln?10:a>=Xn?5:a>=Hn?2:1)}function Un(t,e){return null==t||null==e?NaN:t<e?-1:t>e?1:t>=e?0:NaN}function Wn(t,e){return null==t||null==e?NaN:e<t?-1:e>t?1:e>=t?0:NaN}function Vn(t){let e,n,r;function i(t,r,i=0,a=t.length){if(i<a){if(0!==e(r,r))return a;do{const e=i+a>>>1;n(t[e],r)<0?i=e+1:a=e}while(i<a)}return i}return 2!==t.length?(e=Un,n=(e,n)=>Un(t(e),n),r=(e,n)=>t(e)-n):(e=t===Un||t===Wn?t:Gn,n=t,r=t),{left:i,center:function(t,e,n=0,a=t.length){const o=i(t,e,n,a-1);return o>n&&r(t[o-1],e)>-r(t[o],e)?o-1:o},right:function(t,r,i=0,a=t.length){if(i<a){if(0!==e(r,r))return a;do{const e=i+a>>>1;n(t[e],r)<=0?i=e+1:a=e}while(i<a)}return i}}}function Gn(){return 0}const Kn=Vn(Un),Jn=Kn.right,Qn=(Kn.left,Vn((function(t){return null===t?NaN:+t})).center,Jn);function Zn(t,e){var n,r=e?e.length:0,i=t?Math.min(r,t.length):0,a=new Array(i),o=new Array(r);for(n=0;n<i;++n)a[n]=rr(t[n],e[n]);for(;n<r;++n)o[n]=e[n];return function(t){for(n=0;n<i;++n)o[n]=a[n](t);return o}}function tr(t,e){var n=new Date;return t=+t,e=+e,function(r){return n.setTime(t*(1-r)+e*r),n}}function er(t,e){var n,r={},i={};for(n in null!==t&&"object"==typeof t||(t={}),null!==e&&"object"==typeof e||(e={}),e)n in t?r[n]=rr(t[n],e[n]):i[n]=e[n];return function(t){for(n in r)i[n]=r[n](t);return i}}function nr(t,e){e||(e=[]);var n,r=t?Math.min(e.length,t.length):0,i=e.slice();return function(a){for(n=0;n<r;++n)i[n]=t[n]*(1-a)+e[n]*a;return i}}function rr(t,e){var n,r,i=typeof e;return null==e||"boolean"===i?Xe(e):("number"===i?Kt:"string"===i?(n=Ae(e))?(e=n,Ye):Ge:e instanceof Ae?Ye:e instanceof Date?tr:(r=e,!ArrayBuffer.isView(r)||r instanceof DataView?Array.isArray(e)?Zn:"function"!=typeof e.valueOf&&"function"!=typeof e.toString||isNaN(e)?er:Kt:nr))(t,e)}function ir(t,e){return t=+t,e=+e,function(n){return Math.round(t*(1-n)+e*n)}}function ar(t){return+t}var or=[0,1];function sr(t){return t}function ur(t,e){return(e-=t=+t)?function(n){return(n-t)/e}:(n=isNaN(e)?NaN:.5,function(){return n});var n}function lr(t,e,n){var r=t[0],i=t[1],a=e[0],o=e[1];return i<r?(r=ur(i,r),a=n(o,a)):(r=ur(r,i),a=n(a,o)),function(t){return a(r(t))}}function cr(t,e,n){var r=Math.min(t.length,e.length)-1,i=new Array(r),a=new Array(r),o=-1;for(t[r]<t[0]&&(t=t.slice().reverse(),e=e.slice().reverse());++o<r;)i[o]=ur(t[o],t[o+1]),a[o]=n(e[o],e[o+1]);return function(e){var n=Qn(t,e,1,r)-1;return a[n](i[n](e))}}function fr(t,e){return e.domain(t.domain()).range(t.range()).interpolate(t.interpolate()).clamp(t.clamp()).unknown(t.unknown())}function hr(){return function(){var t,e,n,r,i,a,o=or,s=or,u=rr,l=sr;function c(){var t,e,n,u=Math.min(o.length,s.length);return l!==sr&&(t=o[0],e=o[u-1],t>e&&(n=t,t=e,e=n),l=function(n){return Math.max(t,Math.min(e,n))}),r=u>2?cr:lr,i=a=null,f}function f(e){return null==e||isNaN(e=+e)?n:(i||(i=r(o.map(t),s,u)))(t(l(e)))}return f.invert=function(n){return l(e((a||(a=r(s,o.map(t),Kt)))(n)))},f.domain=function(t){return arguments.length?(o=Array.from(t,ar),c()):o.slice()},f.range=function(t){return arguments.length?(s=Array.from(t),c()):s.slice()},f.rangeRound=function(t){return s=Array.from(t),u=ir,c()},f.clamp=function(t){return arguments.length?(l=!!t||sr,c()):l!==sr},f.interpolate=function(t){return arguments.length?(u=t,c()):u},f.unknown=function(t){return arguments.length?(n=t,f):n},function(n,r){return t=n,e=r,c()}}()(sr,sr)}function dr(t,e){switch(arguments.length){case 0:break;case 1:this.range(t);break;default:this.range(e).domain(t)}return this}var pr,gr=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function mr(t){if(!(e=gr.exec(t)))throw new Error("invalid format: "+t);var e;return new vr({fill:e[1],align:e[2],sign:e[3],symbol:e[4],zero:e[5],width:e[6],comma:e[7],precision:e[8]&&e[8].slice(1),trim:e[9],type:e[10]})}function vr(t){this.fill=void 0===t.fill?" ":t.fill+"",this.align=void 0===t.align?">":t.align+"",this.sign=void 0===t.sign?"-":t.sign+"",this.symbol=void 0===t.symbol?"":t.symbol+"",this.zero=!!t.zero,this.width=void 0===t.width?void 0:+t.width,this.comma=!!t.comma,this.precision=void 0===t.precision?void 0:+t.precision,this.trim=!!t.trim,this.type=void 0===t.type?"":t.type+""}function br(t,e){if((n=(t=e?t.toExponential(e-1):t.toExponential()).indexOf("e"))<0)return null;var n,r=t.slice(0,n);return[r.length>1?r[0]+r.slice(2):r,+t.slice(n+1)]}function yr(t){return(t=br(Math.abs(t)))?t[1]:NaN}function wr(t,e){var n=br(t,e);if(!n)return t+"";var r=n[0],i=n[1];return i<0?"0."+new Array(-i).join("0")+r:r.length>i+1?r.slice(0,i+1)+"."+r.slice(i+1):r+new Array(i-r.length+2).join("0")}mr.prototype=vr.prototype,vr.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(void 0===this.width?"":Math.max(1,0|this.width))+(this.comma?",":"")+(void 0===this.precision?"":"."+Math.max(0,0|this.precision))+(this.trim?"~":"")+this.type};const xr={"%":(t,e)=>(100*t).toFixed(e),b:t=>Math.round(t).toString(2),c:t=>t+"",d:function(t){return Math.abs(t=Math.round(t))>=1e21?t.toLocaleString("en").replace(/,/g,""):t.toString(10)},e:(t,e)=>t.toExponential(e),f:(t,e)=>t.toFixed(e),g:(t,e)=>t.toPrecision(e),o:t=>Math.round(t).toString(8),p:(t,e)=>wr(100*t,e),r:wr,s:function(t,e){var n=br(t,e);if(!n)return t+"";var r=n[0],i=n[1],a=i-(pr=3*Math.max(-8,Math.min(8,Math.floor(i/3))))+1,o=r.length;return a===o?r:a>o?r+new Array(a-o+1).join("0"):a>0?r.slice(0,a)+"."+r.slice(a):"0."+new Array(1-a).join("0")+br(t,Math.max(0,e+a-1))[0]},X:t=>Math.round(t).toString(16).toUpperCase(),x:t=>Math.round(t).toString(16)};function _r(t){return t}var Mr,kr,Ar,Sr=Array.prototype.map,Nr=["y","z","a","f","p","n","µ","m","","k","M","G","T","P","E","Z","Y"];function qr(t){var e=t.domain;return t.ticks=function(t){var n=e();return function(t,e,n){var r,i,a,o,s=-1;if(n=+n,(t=+t)==(e=+e)&&n>0)return[t];if((r=e<t)&&(i=t,t=e,e=i),0===(o=Yn(t,e,n))||!isFinite(o))return[];if(o>0){let n=Math.round(t/o),r=Math.round(e/o);for(n*o<t&&++n,r*o>e&&--r,a=new Array(i=r-n+1);++s<i;)a[s]=(n+s)*o}else{o=-o;let n=Math.round(t*o),r=Math.round(e*o);for(n/o<t&&++n,r/o>e&&--r,a=new Array(i=r-n+1);++s<i;)a[s]=(n+s)/o}return r&&a.reverse(),a}(n[0],n[n.length-1],null==t?10:t)},t.tickFormat=function(t,n){var r=e();return function(t,e,n,r){var i,a=function(t,e,n){var r=Math.abs(e-t)/Math.max(0,n),i=Math.pow(10,Math.floor(Math.log(r)/Math.LN10)),a=r/i;return a>=Ln?i*=10:a>=Xn?i*=5:a>=Hn&&(i*=2),e<t?-i:i}(t,e,n);switch((r=mr(null==r?",f":r)).type){case"s":var o=Math.max(Math.abs(t),Math.abs(e));return null!=r.precision||isNaN(i=function(t,e){return Math.max(0,3*Math.max(-8,Math.min(8,Math.floor(yr(e)/3)))-yr(Math.abs(t)))}(a,o))||(r.precision=i),Ar(r,o);case"":case"e":case"g":case"p":case"r":null!=r.precision||isNaN(i=function(t,e){return t=Math.abs(t),e=Math.abs(e)-t,Math.max(0,yr(e)-yr(t))+1}(a,Math.max(Math.abs(t),Math.abs(e))))||(r.precision=i-("e"===r.type));break;case"f":case"%":null!=r.precision||isNaN(i=function(t){return Math.max(0,-yr(Math.abs(t)))}(a))||(r.precision=i-2*("%"===r.type))}return kr(r)}(r[0],r[r.length-1],null==t?10:t,n)},t.nice=function(n){null==n&&(n=10);var r,i,a=e(),o=0,s=a.length-1,u=a[o],l=a[s],c=10;for(l<u&&(i=u,u=l,l=i,i=o,o=s,s=i);c-- >0;){if((i=Yn(u,l,n))===r)return a[o]=u,a[s]=l,e(a);if(i>0)u=Math.floor(u/i)*i,l=Math.ceil(l/i)*i;else{if(!(i<0))break;u=Math.ceil(u*i)/i,l=Math.floor(l*i)/i}r=i}return t},t}function Cr(){var t=hr();return t.copy=function(){return fr(t,Cr())},dr.apply(t,arguments),qr(t)}function Er(t){for(var e=t.length/6|0,n=new Array(e),r=0;r<e;)n[r]="#"+t.slice(6*r,6*++r);return n}function Ir(t){var e=t.length;return function(n){return t[Math.max(0,Math.min(e-1,Math.floor(n*e)))]}}Mr=function(t){var e,n,r=void 0===t.grouping||void 0===t.thousands?_r:(e=Sr.call(t.grouping,Number),n=t.thousands+"",function(t,r){for(var i=t.length,a=[],o=0,s=e[0],u=0;i>0&&s>0&&(u+s+1>r&&(s=Math.max(1,r-u)),a.push(t.substring(i-=s,i+s)),!((u+=s+1)>r));)s=e[o=(o+1)%e.length];return a.reverse().join(n)}),i=void 0===t.currency?"":t.currency[0]+"",a=void 0===t.currency?"":t.currency[1]+"",o=void 0===t.decimal?".":t.decimal+"",s=void 0===t.numerals?_r:function(t){return function(e){return e.replace(/[0-9]/g,(function(e){return t[+e]}))}}(Sr.call(t.numerals,String)),u=void 0===t.percent?"%":t.percent+"",l=void 0===t.minus?"−":t.minus+"",c=void 0===t.nan?"NaN":t.nan+"";function f(t){var e=(t=mr(t)).fill,n=t.align,f=t.sign,h=t.symbol,d=t.zero,p=t.width,g=t.comma,m=t.precision,v=t.trim,b=t.type;"n"===b?(g=!0,b="g"):xr[b]||(void 0===m&&(m=12),v=!0,b="g"),(d||"0"===e&&"="===n)&&(d=!0,e="0",n="=");var y="$"===h?i:"#"===h&&/[boxX]/.test(b)?"0"+b.toLowerCase():"",w="$"===h?a:/[%p]/.test(b)?u:"",x=xr[b],_=/[defgprs%]/.test(b);function M(t){var i,a,u,h=y,M=w;if("c"===b)M=x(t)+M,t="";else{var k=(t=+t)<0||1/t<0;if(t=isNaN(t)?c:x(Math.abs(t),m),v&&(t=function(t){t:for(var e,n=t.length,r=1,i=-1;r<n;++r)switch(t[r]){case".":i=e=r;break;case"0":0===i&&(i=r),e=r;break;default:if(!+t[r])break t;i>0&&(i=0)}return i>0?t.slice(0,i)+t.slice(e+1):t}(t)),k&&0==+t&&"+"!==f&&(k=!1),h=(k?"("===f?f:l:"-"===f||"("===f?"":f)+h,M=("s"===b?Nr[8+pr/3]:"")+M+(k&&"("===f?")":""),_)for(i=-1,a=t.length;++i<a;)if(48>(u=t.charCodeAt(i))||u>57){M=(46===u?o+t.slice(i+1):t.slice(i))+M,t=t.slice(0,i);break}}g&&!d&&(t=r(t,1/0));var A=h.length+t.length+M.length,S=A<p?new Array(p-A+1).join(e):"";switch(g&&d&&(t=r(S+t,S.length?p-M.length:1/0),S=""),n){case"<":t=h+t+M+S;break;case"=":t=h+S+t+M;break;case"^":t=S.slice(0,A=S.length>>1)+h+t+M+S.slice(A);break;default:t=S+h+t+M}return s(t)}return m=void 0===m?6:/[gprs]/.test(b)?Math.max(1,Math.min(21,m)):Math.max(0,Math.min(20,m)),M.toString=function(){return t+""},M}return{format:f,formatPrefix:function(t,e){var n=f(((t=mr(t)).type="f",t)),r=3*Math.max(-8,Math.min(8,Math.floor(yr(e)/3))),i=Math.pow(10,-r),a=Nr[8+r/3];return function(t){return n(i*t)+a}}}}({thousands:",",grouping:[3],currency:["$",""]}),kr=Mr.format,Ar=Mr.formatPrefix;const jr=Ir(Er("44015444025645045745055946075a46085c460a5d460b5e470d60470e6147106347116447136548146748166848176948186a481a6c481b6d481c6e481d6f481f70482071482173482374482475482576482677482878482979472a7a472c7a472d7b472e7c472f7d46307e46327e46337f463480453581453781453882443983443a83443b84433d84433e85423f854240864241864142874144874045884046883f47883f48893e49893e4a893e4c8a3d4d8a3d4e8a3c4f8a3c508b3b518b3b528b3a538b3a548c39558c39568c38588c38598c375a8c375b8d365c8d365d8d355e8d355f8d34608d34618d33628d33638d32648e32658e31668e31678e31688e30698e306a8e2f6b8e2f6c8e2e6d8e2e6e8e2e6f8e2d708e2d718e2c718e2c728e2c738e2b748e2b758e2a768e2a778e2a788e29798e297a8e297b8e287c8e287d8e277e8e277f8e27808e26818e26828e26828e25838e25848e25858e24868e24878e23888e23898e238a8d228b8d228c8d228d8d218e8d218f8d21908d21918c20928c20928c20938c1f948c1f958b1f968b1f978b1f988b1f998a1f9a8a1e9b8a1e9c891e9d891f9e891f9f881fa0881fa1881fa1871fa28720a38620a48621a58521a68522a78522a88423a98324aa8325ab8225ac8226ad8127ad8128ae8029af7f2ab07f2cb17e2db27d2eb37c2fb47c31b57b32b67a34b67935b77937b87838b9773aba763bbb753dbc743fbc7340bd7242be7144bf7046c06f48c16e4ac16d4cc26c4ec36b50c46a52c56954c56856c66758c7655ac8645cc8635ec96260ca6063cb5f65cb5e67cc5c69cd5b6ccd5a6ece5870cf5773d05675d05477d1537ad1517cd2507fd34e81d34d84d44b86d54989d5488bd6468ed64590d74393d74195d84098d83e9bd93c9dd93ba0da39a2da37a5db36a8db34aadc32addc30b0dd2fb2dd2db5de2bb8de29bade28bddf26c0df25c2df23c5e021c8e020cae11fcde11dd0e11cd2e21bd5e21ad8e219dae319dde318dfe318e2e418e5e419e7e419eae51aece51befe51cf1e51df4e61ef6e620f8e621fbe723fde725"));function Pr(t,e,n){this.k=t,this.x=e,this.y=n}function Tr(t){return Math.floor(Math.random()*t)}function zr(t,e,...n){let r=Array(t);for(let i=0;i<t;i++)r[i]=e(...n);return r}function Dr(t){return Array(t).fill(0)}function $r(t,e){let n=Array(t.length);for(let r=0;r<n.length;r++)n[r]=t[r]-e[r];return n}function Br(t,e){let n=Array(t.length);for(let r=0;r<n.length;r++)n[r]=t[r]+e[r];return n}function Fr(t,e){let n=0;for(let r=0;r<t.length;r++)n+=t[r]*e[r];return n}function Rr(t,e){let n=Array(t.length);for(let r=0;r<n.length;r++)n[r]=t[r]*e;return n}function Or(t,e){return zr(t,Dr,e)}function Lr(t,e,n){let r=e.length,i=e[0].length,a=n.length;for(let o=0;o<r;o++)for(let r=0;r<a;r++){let a=0;for(let t=0;t<i;t++)a+=e[o][t]*n[r][t];t[o][r]=a}}function Xr(t,e){let n=zr(t.length,Array,t[0].length);for(let r=0;r<t.length;r++)for(let i=0;i<t[0].length;i++)n[r][i]=t[r][i]+e[r][i];return n}function Hr(t,e){return t.map((t=>t.map((t=>t*e))))}function Yr(t,e){for(let n=0;n<t.length;n++)for(let r=0;r<t[0].length;r++)t[n][r]*=e}function Ur(t,e){for(let n=0;n<t.length;n++)for(let r=0;r<t[0].length;r++)t[n][r]+=e[n][r]}function Wr(t){let e=zr(t[0].length,Array,t.length);for(let n=0;n<t.length;n++)for(let r=0;r<t[0].length;r++)e[r][n]=t[n][r];return e}function Vr(t,e){let n=[...t];for(let r=0;r<n.length;r++)for(let i=0;i<e.length;i++)n[r]=$r(n[r],Rr(e[i],Fr(t[r],e[i])));return n}function Gr(t,e){return t.hasOwnProperty(e)}function Kr(t){"none"==t.style.display?t.style.display="block":t.style.display="none"}function Jr(t){return((t=Math.max(0,Math.min(255,Math.round(t))))<16?"0":"")+t.toString(16)}function Qr(t,e,n,r,i){let a=t.length,o=t[0].length,s=Array(a),u=Or(a,o),l=Tr(e.length),c=Tr(e.length);for(let i=0;i<5e3;i++){let f=$r(e[(i+l)%e.length],e[(i+c)%e.length]);for(let e=0;e<a;e++)s[e]=Fr(f,t[e]);let h=Math.pow(Fr(s,s)+r*r,n-1);for(let t=0;t<a;t++)for(let e=0;e<o;e++)u[t][e]+=f[e]*s[t]*h}return Yr(u,-4e-4*i),u}function Zr(t,e,n,r,i){let a=t.length,o=t[0].length,s=Array(a),u=Or(a,o);for(let i=0;i<e.length;i++){let l=e[i];for(let e=0;e<a;e++)s[e]=Fr(l,t[e]);let c=Math.pow(Fr(s,s)+r*r,n-1);for(let t=0;t<a;t++)for(let e=0;e<o;e++)u[t][e]+=l[e]*s[t]*c}return Yr(u,-2/e.length*i),u}Ir(Er("00000401000501010601010802010902020b02020d03030f03031204041405041606051806051a07061c08071e0907200a08220b09240c09260d0a290e0b2b100b2d110c2f120d31130d34140e36150e38160f3b180f3d19103f1a10421c10441d11471e114920114b21114e22115024125325125527125829115a2a115c2c115f2d11612f116331116533106734106936106b38106c390f6e3b0f703d0f713f0f72400f74420f75440f764510774710784910784a10794c117a4e117b4f127b51127c52137c54137d56147d57157e59157e5a167e5c167f5d177f5f187f601880621980641a80651a80671b80681c816a1c816b1d816d1d816e1e81701f81721f817320817521817621817822817922827b23827c23827e24828025828125818326818426818627818827818928818b29818c29818e2a81902a81912b81932b80942c80962c80982d80992d809b2e7f9c2e7f9e2f7fa02f7fa1307ea3307ea5317ea6317da8327daa337dab337cad347cae347bb0357bb2357bb3367ab5367ab73779b83779ba3878bc3978bd3977bf3a77c03a76c23b75c43c75c53c74c73d73c83e73ca3e72cc3f71cd4071cf4070d0416fd2426fd3436ed5446dd6456cd8456cd9466bdb476adc4869de4968df4a68e04c67e24d66e34e65e44f64e55064e75263e85362e95462ea5661eb5760ec5860ed5a5fee5b5eef5d5ef05f5ef1605df2625df2645cf3655cf4675cf4695cf56b5cf66c5cf66e5cf7705cf7725cf8745cf8765cf9785df9795df97b5dfa7d5efa7f5efa815ffb835ffb8560fb8761fc8961fc8a62fc8c63fc8e64fc9065fd9266fd9467fd9668fd9869fd9a6afd9b6bfe9d6cfe9f6dfea16efea36ffea571fea772fea973feaa74feac76feae77feb078feb27afeb47bfeb67cfeb77efeb97ffebb81febd82febf84fec185fec287fec488fec68afec88cfeca8dfecc8ffecd90fecf92fed194fed395fed597fed799fed89afdda9cfddc9efddea0fde0a1fde2a3fde3a5fde5a7fde7a9fde9aafdebacfcecaefceeb0fcf0b2fcf2b4fcf4b6fcf6b8fcf7b9fcf9bbfcfbbdfcfdbf")),Ir(Er("00000401000501010601010802010a02020c02020e03021004031204031405041706041907051b08051d09061f0a07220b07240c08260d08290e092b10092d110a30120a32140b34150b37160b39180c3c190c3e1b0c411c0c431e0c451f0c48210c4a230c4c240c4f260c51280b53290b552b0b572d0b592f0a5b310a5c320a5e340a5f3609613809623909633b09643d09653e0966400a67420a68440a68450a69470b6a490b6a4a0c6b4c0c6b4d0d6c4f0d6c510e6c520e6d540f6d550f6d57106e59106e5a116e5c126e5d126e5f136e61136e62146e64156e65156e67166e69166e6a176e6c186e6d186e6f196e71196e721a6e741a6e751b6e771c6d781c6d7a1d6d7c1d6d7d1e6d7f1e6c801f6c82206c84206b85216b87216b88226a8a226a8c23698d23698f24699025689225689326679526679727669827669a28659b29649d29649f2a63a02a63a22b62a32c61a52c60a62d60a82e5fa92e5eab2f5ead305dae305cb0315bb1325ab3325ab43359b63458b73557b93556ba3655bc3754bd3853bf3952c03a51c13a50c33b4fc43c4ec63d4dc73e4cc83f4bca404acb4149cc4248ce4347cf4446d04545d24644d34743d44842d54a41d74b3fd84c3ed94d3dda4e3cdb503bdd513ade5238df5337e05536e15635e25734e35933e45a31e55c30e65d2fe75e2ee8602de9612bea632aeb6429eb6628ec6726ed6925ee6a24ef6c23ef6e21f06f20f1711ff1731df2741cf3761bf37819f47918f57b17f57d15f67e14f68013f78212f78410f8850ff8870ef8890cf98b0bf98c0af98e09fa9008fa9207fa9407fb9606fb9706fb9906fb9b06fb9d07fc9f07fca108fca309fca50afca60cfca80dfcaa0ffcac11fcae12fcb014fcb216fcb418fbb61afbb81dfbba1ffbbc21fbbe23fac026fac228fac42afac62df9c72ff9c932f9cb35f8cd37f8cf3af7d13df7d340f6d543f6d746f5d949f5db4cf4dd4ff4df53f4e156f3e35af3e55df2e661f2e865f2ea69f1ec6df1ed71f1ef75f1f179f2f27df2f482f3f586f3f68af4f88ef5f992f6fa96f8fb9af9fc9dfafda1fcffa4")),Ir(Er("0d088710078813078916078a19068c1b068d1d068e20068f2206902406912605912805922a05932c05942e05952f059631059733059735049837049938049a3a049a3c049b3e049c3f049c41049d43039e44039e46039f48039f4903a04b03a14c02a14e02a25002a25102a35302a35502a45601a45801a45901a55b01a55c01a65e01a66001a66100a76300a76400a76600a76700a86900a86a00a86c00a86e00a86f00a87100a87201a87401a87501a87701a87801a87a02a87b02a87d03a87e03a88004a88104a78305a78405a78606a68707a68808a68a09a58b0aa58d0ba58e0ca48f0da4910ea3920fa39410a29511a19613a19814a099159f9a169f9c179e9d189d9e199da01a9ca11b9ba21d9aa31e9aa51f99a62098a72197a82296aa2395ab2494ac2694ad2793ae2892b02991b12a90b22b8fb32c8eb42e8db52f8cb6308bb7318ab83289ba3388bb3488bc3587bd3786be3885bf3984c03a83c13b82c23c81c33d80c43e7fc5407ec6417dc7427cc8437bc9447aca457acb4679cc4778cc4977cd4a76ce4b75cf4c74d04d73d14e72d24f71d35171d45270d5536fd5546ed6556dd7566cd8576bd9586ada5a6ada5b69db5c68dc5d67dd5e66de5f65de6164df6263e06363e16462e26561e26660e3685fe4695ee56a5de56b5de66c5ce76e5be76f5ae87059e97158e97257ea7457eb7556eb7655ec7754ed7953ed7a52ee7b51ef7c51ef7e50f07f4ff0804ef1814df1834cf2844bf3854bf3874af48849f48948f58b47f58c46f68d45f68f44f79044f79143f79342f89441f89540f9973ff9983ef99a3efa9b3dfa9c3cfa9e3bfb9f3afba139fba238fca338fca537fca636fca835fca934fdab33fdac33fdae32fdaf31fdb130fdb22ffdb42ffdb52efeb72dfeb82cfeba2cfebb2bfebd2afebe2afec029fdc229fdc328fdc527fdc627fdc827fdca26fdcb26fccd25fcce25fcd025fcd225fbd324fbd524fbd724fad824fada24f9dc24f9dd25f8df25f8e125f7e225f7e425f6e626f6e826f5e926f5eb27f4ed27f3ee27f3f027f2f227f1f426f1f525f0f724f0f921")),Pr.prototype={constructor:Pr,scale:function(t){return 1===t?this:new Pr(this.k*t,this.x,this.y)},translate:function(t,e){return 0===t&0===e?this:new Pr(this.k,this.x+this.k*t,this.y+this.k*e)},apply:function(t){return[t[0]*this.k+this.x,t[1]*this.k+this.y]},applyX:function(t){return t*this.k+this.x},applyY:function(t){return t*this.k+this.y},invert:function(t){return[(t[0]-this.x)/this.k,(t[1]-this.y)/this.k]},invertX:function(t){return(t-this.x)/this.k},invertY:function(t){return(t-this.y)/this.k},rescaleX:function(t){return t.copy().domain(t.range().map(this.invertX,this).map(t.invert,t))},rescaleY:function(t){return t.copy().domain(t.range().map(this.invertY,this).map(t.invert,t))},toString:function(){return"translate("+this.x+","+this.y+") scale("+this.k+")"}},new Pr(1,0,0),Pr.prototype;let ti={ultralocal:(t,e)=>Qr(t,e,-1,.05,.01),local:(t,e)=>Qr(t,e,0,.01,.5),pca:(t,e)=>Qr(t,e,1,0,.5),outlier:(t,e)=>Qr(t,e,2,0,5),push:(t,e)=>Zr(t,e,.5,.01,.5),pull:(t,e)=>Zr(t,e,.5,.01,-.2)};const{normal:ei}=t;let ni='~\n<div>~\n    <style>\n        /* Reset all host styling. */\n        :host {\n            all: initial;\n        }\n        \n        * { font-family: sans-serif; }\n        input { vertical-align: middle; }\n        input[type=checkbox] { vertical-align: baseline; }\n        input[type=range] { width: 150px; }\n        \n        .controlDiv {\n            display: flex;\n            flex-wrap: wrap;\n            align-items: center;\n        }\n        \n        .box { \n            background: #eee;\n            padding: 4px 6px 4px 6px; \n            margin: 4px 4px 4px 4px;\n            border-radius: 4px;\n            vertical-align: middle;\n        }\n        \n        .controlButton {\n            padding: 0px;\n            margin: 4px 4px 4px 4px;\n            vertical-align: middle;\n            height: 26px;\n            width: 26px;\n        }\n        \n        .infoBox {\n            visibility: hidden;\n            position: absolute;\n            left: 10px;\n            bottom: 0px;\n            padding: 8px;\n            background: #eee;\n            border: 1px solid black;\n            border-radius: 4px;\n        }\n        \n        .messageArea {\n            position: absolute;\n            white-space: pre;\n            text-align: right;\n            right: 0px;\n            bottom: 0px;\n            color: #888;\n            background: #ffffffff;\n            padding: 3px;\n            border-radius: 4px;\n        }\n        \n        .labelDiv {\n            white-space: nowrap;\n            position: absolute;\n            border-radius: 3px;\n            padding: 2px 5px 1px 0px;\n            cursor: grab;  \n            user-select: none;\n            font-size: 15px;\n        }\n        \n        .labelDiv input {\n            padding: 0px;\n            margin: 0px 5px 0px 0px;\n        }\n        \n        table {\n            border-spacing: 0px;\n        }\n        \n        tr:hover td { background: #ddddff; }\n        \n        .canvas { \n            display: block; \n        }\n    </style>~\n\n    <div style="position: relative" class=plotDiv>~\n        <canvas class=canvas></canvas>~\n        <div class=messageArea></div>~\n        <div class=overlay style="position: absolute; left:0; top:0;"></div>~\n        <div class=infoBox>~\n            <div><b><a href="https://logarithmic.net/langevitour/" target="_blank">langevitour</a></b></div>\n            <br><div><button class=infoBoxProjButton>Projection &#9662;</button></div>\n            <textarea class=infoBoxProj rows=5 cols=30 wrap=off spellcheck=false onclick="this.setSelectionRange(0,this.value.length,\'backward\');" style="display: none"></textarea>\n            <br><div><button class=infoBoxStateButton>State &#9662;</button></div>\n            <textarea class=infoBoxState rows=7 cols=30 wrap=off spellcheck=false onfocus="this.setSelectionRange(0,this.value.length,\'backward\');" style="display: none"></textarea>\n            <div class=infoBoxInfo></div>\n            <table>\n              <tr><td>Brush size</td><td><input type=range min=-1 max=1 step=0.01 value=0 class=brushInput></td></tr>\n              <tr><td>Zoom</td><td><input type=range min=-1 max=1 step=0.01 value=0 class=zoomInput></td></tr>\n              <tr><td>Damping</td><td><input type=range min=-3 max=3 step=0.01 value=0 class=dampInput></td></tr>\n              <tr><td>Heat</td><td><input type=range min=-2 max=4 step=0.01 value=0 class=heatInput></td></tr>\n              <tr><td>Label strength</td><td><input type=range min=-3 max=1 step=0.01 value=0 class=labelInput></td></tr>\n              <tr><td>Guide strength</td><td><input type=range min=-2 max=2 step=0.01 value=0 class=guideInput></td></tr>\n            </table>\n        </div>~\n    </div>~\n\n    <div class=controlDiv>~\n        <button class="controlButton fullscreenButton" title="Full screen">~\n            <svg  width=20 height=20 version="1.1" viewBox="0 0 20 20" style="vertical-align: middle;">\n                <rect x=2 y=2 width=6 height=2 />\n                <rect x=2 y=2 width=2 height=6 />\n                <rect x=12 y=2 width=6 height=2 />\n                <rect x=16 y=2 width=2 height=6 />\n                <rect x=2 y=16 width=6 height=2 />\n                <rect x=2 y=12 width=2 height=6 />\n                <rect x=12 y=16 width=6 height=2 />\n                <rect x=16 y=12 width=2 height=6 />\n            </svg>~\n        </button>~\n        \n        <button class="controlButton infoButton" title="Further controls and information">~\n            <svg viewBox="0 0 20 20" width=20 height=20 style="vertical-align: middle;">\n                <rect x="4" y="5" width="12" height="2"></rect>\n                <rect x="4" y="9" width="12" height="2"></rect>\n                <rect x="4" y="13" width="12" height="2"></rect>\n            </svg>\n        </button>~\n        \n        <button class="controlButton playButton" title="Play / Pause">~\n        </button>\n        \n        <div class=box>~\n            Guide\n            <select class=guideSelect value=none>\n                <optgroup label="Explore">\n                    <option value=none title="Look at completely random projections.">free</option>\n                </optgroup>\n                <optgroup label="Layout">\n                    <option value=ultralocal title="Try to ensure small things don\'t overlap. May be unstable.">ultralocal</option>\n                    <option value=local title="Try to ensure things don\'t overlap. A good default.">local</option>\n                    <option value=pca title="Equivalent to Principal Components Analysis.">PCA</option>\n                    <option value=outlier title="Find projections with some points very far from other points.">outlier</option>\n                </optgroup>\n                <optgroup label="Central force">\n                    <option value=push title="Push points away from the center.">push</option>\n                    <option value=pull title="Pull points towards the center.">pull</option>\n                </optgroup>\n            </select>~ \n        </div>~\n        \n        <div class=box><label>~\n            <input class=axesCheckbox type=checkbox checked>~\n            axes~\n        </label></div>~\n        \n        <div class=box><label>\n            <input class=heatCheckbox type=checkbox checked>~\n            heat~\n        </label></div>~\n        \n        <div class=box><label>~\n            <input class=labelCheckbox type=checkbox checked>~\n            label attract~\n        </label></div>~\n    </div>~\n</div>~\n'.replace(/~\s+/g,"");class ri extends EventTarget{constructor(t,e,n){super(),this.width=1,this.height=1,this.originalWidth=1,this.originalHeight=1,this.size=1,this.pointSize=1,this.center=[],this.scale=[],this.X=[[],[]],this.n=0,this.m=0,this.colnames=[],this.permutor=[],this.unpermutor=[],this.rownames=[],this.group=[],this.levels=[],this.levelColors=[],this.lineFrom=[],this.lineTo=[],this.lineColors=[],this.fills=[],this.filter=null,this.selection=null,this.selectionChanged=!1,this.axes=[],this.labelData=[],this.proj=[[],[]],this.vel=[[],[]],this.zoom=1,this.xScaleUnit=Cr(),this.yScaleUnit=Cr(),this.xScale=Cr(),this.yScale=Cr(),this.xScaleClamped=Cr(),this.yScaleClamped=Cr(),this.haveData=!1,this.playing=!0,this.frameScheduled=!1,this.lastTime=0,this.mouseInCheckbox=!1,this.dragging=!1,this.fps=[],this.computeMessage="",this.mousing=!1,this.mouseDown=!1,this.mouseWentDown=!1,this.mouseShiftKey=!1,this.mouseX=0,this.mouseY=0,this.xy=[[],[]],this.fillsFrame=[],this.pointActive=[],this.container=t;let r=document.createElement("div");this.container.appendChild(r),this.shadow=r.attachShadow({mode:"open"}),this.shadow.innerHTML=ni,this.shadowChild=this.shadow.firstChild,this.canvas=this.get("canvas"),this.overlay=this.get("overlay"),this.container.langevitour=this,this.resize(e,n);let i=this.get("plotDiv");i.addEventListener("mouseover",(t=>{this.mousing=!0,this.scheduleFrameIfNeeded()})),i.addEventListener("mouseout",(t=>{this.mousing=!1,this.mouseDown=!1,this.scheduleFrameIfNeeded()})),i.addEventListener("mousemove",(t=>{let e=i.getBoundingClientRect();this.mouseX=t.x-e.left,this.mouseY=t.y-e.top,this.scheduleFrameIfNeeded()})),i.addEventListener("mousedown",(t=>{if(!t.target.classList.contains("overlay"))return;let e=this.get("infoBox");"visible"!=e.style.visibility?(this.mouseDown=!0,this.mouseWentDown=!0,this.mouseShiftKey=t.shiftKey,this.scheduleFrameIfNeeded()):e.style.visibility="hidden"})),i.addEventListener("mouseup",(t=>{this.mouseDown=!1,this.scheduleFrameIfNeeded()})),null==this.container.requestFullscreen&&(this.get("fullscreenButton").style.display="none"),this.get("fullscreenButton").addEventListener("click",(()=>{document.fullscreenElement?document.exitFullscreen&&document.exitFullscreen():this.shadowChild.requestFullscreen()})),this.shadowChild.addEventListener("fullscreenchange",(()=>{let t=this.shadowChild;if(document.fullscreenElement){this.originalWidth=this.width,this.originalHeight=this.height;let e=Math.max(0,t.offsetWidth-t.offsetHeight)/2;t.style.paddingLeft=e+"px",this.width=t.offsetWidth-e,this.height=t.offsetHeight,this.configure()}else t.style.paddingLeft="0px",this.width=this.originalWidth,this.height=this.originalHeight,this.configure()})),this.get("infoButton").addEventListener("click",(()=>{let t=this.get("infoBox");"visible"!=t.style.visibility&&this.haveData?(t.style.visibility="visible",this.get("infoBoxProj").style.display="none",this.get("infoBoxState").style.display="none",this.get("infoBoxInfo").innerHTML=`<p>${this.X.length.toLocaleString("en-US")} points.</p>`):t.style.visibility="hidden"})),this.get("infoBoxProjButton").addEventListener("click",(()=>{let t=this.getInput("infoBoxProj");if(Kr(t),"none"!=t.style.display){let t="projection <- cbind(\n    c(";t+=this.proj.map((t=>t.map(((t,e)=>(t/this.scale[e]).toFixed(Math.ceil(Math.log10(Math.max(0,this.scale[e]))+4)))).join(","))).join("),\n    c("),t+="))\nprojected <- as.matrix(X) %*% projection",this.getInput("infoBoxProj").value=t}})),this.get("infoBoxStateButton").addEventListener("click",(()=>{let t=this.getInput("infoBoxState");Kr(t),"none"!=t.style.display&&(t.value=JSON.stringify(this.getState(),null,4))})),this.get("playButton").addEventListener("click",(()=>this.setState({playing:!this.playing})))}get(t){return this.shadowChild.getElementsByClassName(t)[0]}getInput(t){return this.get(t)}getString(t){return this.getInput(t).value}getNumber(t){return Number(this.getInput(t).value)}getChecked(t){return this.getInput(t).checked}emitChangeFilter(){setTimeout((()=>this.dispatchEvent(new Event("changeFilter"))),0)}emitChangeSelectionIfNeeded(){this.selectionChanged&&(this.selectionChanged=!1,setTimeout((()=>this.dispatchEvent(new Event("changeSelection"))),0))}renderValue(t){if(!t)return this.haveData=!1,void this.configure();this.haveData=!0,this.n=t.X.length,this.m=t.X[0].length,this.pointSize=null!=t.pointSize?t.pointSize:1;let e=t.axisColors||[];this.center=t.center||Array(this.m).fill(0),this.scale=t.scale||Array(this.m).fill(1),this.permutor=function(t){let e=Array(t).fill(0).map(((t,e)=>e));for(let t=e.length-1;t>0;t--){const n=Tr(t+1);[e[t],e[n]]=[e[n],e[t]]}return e}(this.n),this.unpermutor=Array(this.n);for(let t=0;t<this.n;t++)this.unpermutor[this.permutor[t]]=t;if(this.X=this.permutor.map((e=>t.X[e])),this.X=this.X.map((t=>t.map(((t,e)=>(t-this.center[e])/this.scale[e])))),t.rownames&&0!=t.rownames.length){let e=t.rownames;this.rownames=this.permutor.map((t=>e[t]))}else this.rownames=[];if(this.colnames=t.colnames,this.lineFrom=(t.lineFrom||[]).map((t=>this.unpermutor[t])),this.lineTo=(t.lineTo||[]).map((t=>this.unpermutor[t])),this.lineColors=t.lineColors||[],this.lineFrom.length&&!this.lineColors.length&&(this.lineColors=this.lineFrom.map((()=>"#00000088"))),this.axes=[],t.extraAxes&&t.extraAxesNames)for(let n=0;n<t.extraAxes[0].length;n++){let r=t.extraAxes.map((t=>t[n])),i=Fr(r,this.center),a=r.map(((t,e)=>t*this.scale[e])),o=Math.sqrt(Fr(a,a)),s=Rr(a,1/o);this.axes.push({name:t.extraAxesNames[n],unit:s,scale:o,center:i,color:e[n+this.m],proj:[]})}for(let n=0;n<this.m;n++){let r=Dr(this.m);r[n]=1,this.axes.push({name:t.colnames[n],center:this.center[n],scale:this.scale[n],unit:r,color:e[n],proj:[]})}for(let t=0;t<this.axes.length;t++)this.axes[t].proj=this.X.map((e=>Fr(e,this.axes[t].unit)));this.levels=t.levels,this.group=this.permutor.map((e=>t.group[e]));let n=this.levels.length;this.levelColors=(t.levelColors||[]).slice();for(let t=this.levelColors.length;t<n;t++){let e=(t+1/3)/n,r=104,i=r*(1+Math.cos(e*Math.PI*2)),a=r*(1+Math.cos((e+1/3)*Math.PI*2)),o=r*(1+Math.cos((e+2/3)*Math.PI*2));this.levelColors[t]=Ce(i,a,o).formatHex()}let r=null==t.colorVariation?.3:t.colorVariation;this.fills=[];for(let t=0;t<this.n;t++){let e=Ce(this.levelColors[this.group[t]]),n=1+r*(t/this.n*2-1);e.r*=n,e.g*=n,e.b*=n,this.fills[t]=e.formatHex()}if(this.labelData=[],this.levels.length>1)for(let t=0;t<this.levels.length;t++){let e=Dr(this.m);for(let n=0;n<this.n;n++)this.group[n]==t&&(e=Br(e,this.X[n]));e=Rr(e,1/Math.sqrt(Fr(e,e))),this.labelData.push({type:"level",index:t,label:this.levels[t],vec:e,color:this.levelColors[t],active:!0,x:2,y:0,halfWidth:0,halfHeight:0,selected:0})}for(let t=0;t<this.axes.length;t++)this.labelData.push({type:"axis",index:t,label:this.axes[t].name,vec:this.axes[t].unit,color:this.axes[t].color||"#000000",active:!0,x:2,y:0,halfWidth:0,halfHeight:0,selected:0});this.proj=Or(2,this.m),this.proj[0][0]=1,this.proj[1][1]=1,this.vel=Or(2,this.m),this.xy=Or(2,this.n),this.fillsFrame=Array(this.n).fill(""),this.pointActive=Array(this.n).fill(!0),this.configure(),t.state&&this.setState(t.state)}resize(t,e){document.fullscreenElement||(this.width=Math.max(200,t),this.height=Math.max(200,e),this.configure())}configure(){this.canvas.style.width=this.width+"px",this.overlay.style.width=this.width+"px";let t=this.get("controlDiv").offsetHeight+5;if(this.size=Math.max(100,Math.min(this.width-100,this.height-t)),this.canvas.style.height=this.size+"px",this.overlay.style.height=this.size+"px",this.get("playButton").innerHTML=this.playing?'<svg viewBox="0 0 20 20" width=20 height=20 style="vertical-align: middle;">\n    <rect x="4" y="4" width="4" height="12"></rect>\n    <rect x="12" y="4" width="4" height="12"></rect>\n</svg>':'<svg viewBox="0 0 20 20" width=20 height=20 style="vertical-align: middle;">\n    <path d="M 6 4 L 16 10 L 6 16 Z">\n</svg>',!this.haveData){this.get("messageArea").innerText="",this.overlay.style.opacity="0";let t=this.canvas.getContext("2d");return t.scale(1,1),void t.clearRect(0,0,this.canvas.width,this.canvas.height)}this.configureScales();let e=En(this.overlay);e.selectAll("*").remove(),this.mouseInCheckbox=!1;let n=this,r=e.selectAll("div").data(this.labelData).join((t=>{let e=t.append("div").classed("labelDiv",!0);return e.append("input").attr("type","checkbox").property("checked",(t=>t.active)).on("change",(function(t,e){e.active=this.checked,n.emitChangeFilter()})).on("mouseover",(()=>{this.mouseInCheckbox=!0})).on("mouseout",(()=>{this.mouseInCheckbox=!1})),e.append("span"),e}));function i(){let t=n.xScaleUnit.invert(n.width);for(let e of n.labelData)e.x=Math.max(-1,Math.min(t,e.x)),e.y=Math.max(-1,Math.min(1,e.y));r.style("left",(t=>n.xScaleUnit(t.x)-t.halfWidth+"px")).style("top",(t=>n.yScaleUnit(t.y)-t.halfHeight+"px")).style("background",(t=>t.selected?"#aaa":"#ddd"))}r.style("cursor","grab").on("mouseover",((t,e)=>{e.selected+=1,i()})).on("mouseout",((t,e)=>{e.selected=Math.max(0,e.selected-1),i()})),r.select("span").text((t=>t.label)).style("color",(t=>t.color)),r.each((function(t){t.halfWidth=this.offsetWidth/2,t.halfHeight=this.offsetHeight/2})),function(){var t,e,n,r,i=Bn,a=Fn,o=Rn,s=On,u={},l=At("start","drag","end"),c=0,f=0;function h(t){t.on("mousedown.drag",d).filter(s).on("touchstart.drag",m).on("touchmove.drag",v,jn).on("touchend.drag touchcancel.drag",b).style("touch-action","none").style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}function d(o,s){if(!r&&i.call(this,o,s)){var u=y(this,a.call(this,o,s),o,s,"mouse");u&&(En(o.view).on("mousemove.drag",p,Pn).on("mouseup.drag",g,Pn),function(t){var e=t.document.documentElement,n=En(t).on("dragstart.drag",zn,Pn);"onselectstart"in e?n.on("selectstart.drag",zn,Pn):(e.__noselect=e.style.MozUserSelect,e.style.MozUserSelect="none")}(o.view),Tn(o),n=!1,t=o.clientX,e=o.clientY,u("start",o))}}function p(r){if(zn(r),!n){var i=r.clientX-t,a=r.clientY-e;n=i*i+a*a>f}u.mouse("drag",r)}function g(t){En(t.view).on("mousemove.drag mouseup.drag",null),function(t,e){var n=t.document.documentElement,r=En(t).on("dragstart.drag",null);e&&(r.on("click.drag",zn,Pn),setTimeout((function(){r.on("click.drag",null)}),0)),"onselectstart"in n?r.on("selectstart.drag",null):(n.style.MozUserSelect=n.__noselect,delete n.__noselect)}(t.view,n),zn(t),u.mouse("end",t)}function m(t,e){if(i.call(this,t,e)){var n,r,o=t.changedTouches,s=a.call(this,t,e),u=o.length;for(n=0;n<u;++n)(r=y(this,s,t,e,o[n].identifier,o[n]))&&(Tn(t),r("start",t,o[n]))}}function v(t){var e,n,r=t.changedTouches,i=r.length;for(e=0;e<i;++e)(n=u[r[e].identifier])&&(zn(t),n("drag",t,r[e]))}function b(t){var e,n,i=t.changedTouches,a=i.length;for(r&&clearTimeout(r),r=setTimeout((function(){r=null}),500),e=0;e<a;++e)(n=u[i[e].identifier])&&(Tn(t),n("end",t,i[e]))}function y(t,e,n,r,i,a){var s,f,d,p=l.copy(),g=In(a||n,e);if(null!=(d=o.call(t,new $n("beforestart",{sourceEvent:n,target:h,identifier:i,active:c,x:g[0],y:g[1],dx:0,dy:0,dispatch:p}),r)))return s=d.x-g[0]||0,f=d.y-g[1]||0,function n(a,o,l){var m,v=g;switch(a){case"start":u[i]=n,m=c++;break;case"end":delete u[i],--c;case"drag":g=In(l||o,e),m=c}p.call(a,t,new $n(a,{sourceEvent:o,subject:d,target:h,identifier:i,active:m,x:g[0]+s,y:g[1]+f,dx:g[0]-v[0],dy:g[1]-v[1],dispatch:p}),r)}}return h.filter=function(t){return arguments.length?(i="function"==typeof t?t:Dn(!!t),h):i},h.container=function(t){return arguments.length?(a="function"==typeof t?t:Dn(t),h):a},h.subject=function(t){return arguments.length?(o="function"==typeof t?t:Dn(t),h):o},h.touchable=function(t){return arguments.length?(s="function"==typeof t?t:Dn(!!t),h):s},h.on=function(){var t=l.on.apply(l,arguments);return t===l?h:t},h.clickDistance=function(t){return arguments.length?(f=(t=+t)*t,h):Math.sqrt(f)},h}().subject((function(t,e){return{x:t.x,y:t.y}})).on("start",(function(t,e){n.mouseInCheckbox||(n.dragging=!0,this.style.cursor="grabbing",e.selected+=1)})).on("drag",(function(t,e){n.dragging&&(e.x=n.xScaleUnit.invert(t.x),e.y=n.yScaleUnit.invert(t.y),i())})).on("end",(function(t,e){n.dragging&&(n.dragging=!1,this.style.cursor="grab",e.selected=Math.max(0,e.selected-1))}))(r);let a=Math.ceil(25*this.labelData.length/(this.size-40));for(let t=0;t<this.labelData.length;t++){let e=this.labelData[t];if(e.selected=0,e.x<1)continue;let n=(t-t%a)/a;e.x=this.xScaleUnit.invert(this.size+10+e.halfWidth+t%a*(this.width-this.size-10)/a),e.y=this.yScaleUnit.invert(20+25*n)}i(),this.scheduleFrameIfNeeded()}configureScales(){this.zoom=Math.pow(10,-this.getNumber("zoomInput")),this.xScaleUnit=Cr().domain([-1,1]).range([2.5,this.size-2.5]),this.yScaleUnit=Cr().domain([-1,1]).range([this.size-2.5,2.5]),this.xScale=Cr().domain([-this.zoom,this.zoom]).range([2.5,this.size-2.5]),this.yScale=Cr().domain([-this.zoom,this.zoom]).range([this.size-2.5,2.5]),this.xScaleClamped=this.xScale.copy().clamp(!0),this.yScaleClamped=this.yScale.copy().clamp(!0)}getState(){let t={};t.playing=this.playing,t.axesOn=this.getChecked("axesCheckbox"),t.heatOn=this.getChecked("heatCheckbox"),t.guideType=this.getString("guideSelect"),t.labelAttractionOn=this.getChecked("labelCheckbox"),t.damping=this.getNumber("dampInput"),t.heat=this.getNumber("heatInput"),t.guide=this.getNumber("guideInput"),t.labelAttraction=this.getNumber("labelInput"),t.zoom=this.getNumber("zoomInput"),t.brush=this.getNumber("brushInput"),t.labelInactive=[],t.labelPos={};for(let e of this.labelData)e.active||t.labelInactive.push(e.label),e.x<1&&(t.labelPos[e.label]=[e.x,e.y]);return t.projection=this.proj,this.selection?t.selection=this.unpermutor.map((t=>this.selection[t])):t.selection=null,this.filter?t.filter=this.unpermutor.map((t=>this.filter[t])):t.filter=null,t}setState(t){let e=!1,n=!1;if("string"==typeof t&&(t=JSON.parse(t)),t){if(Gr(t,"playing")&&(!this.playing&&t.playing&&(this.lastTime=0),this.playing=t.playing),Gr(t,"axesOn")&&(this.getInput("axesCheckbox").checked=t.axesOn),Gr(t,"heatOn")&&(this.getInput("heatCheckbox").checked=t.heatOn),Gr(t,"pointRepulsionType")&&(this.getInput("guideSelect").value=t.pointRepulsionType),Gr(t,"guideType")&&(this.getInput("guideSelect").value=t.guideType),Gr(t,"labelAttractionOn")&&(this.getInput("labelCheckbox").checked=t.labelAttractionOn),Gr(t,"damping")&&(this.getInput("dampInput").value=t.damping),Gr(t,"heat")&&(this.getInput("heatInput").value=t.heat),Gr(t,"pointRepulsion")&&(this.getInput("guideInput").value=t.pointRepulsion),Gr(t,"guide")&&(this.getInput("guideInput").value=t.guide),Gr(t,"labelAttraction")&&(this.getInput("labelInput").value=t.labelAttraction),Gr(t,"zoom")&&(this.getInput("zoomInput").value=t.zoom),Gr(t,"brush")&&(this.getInput("brushInput").value=t.brush),Gr(t,"labelInactive")){for(let e of this.labelData)e.active=!t.labelInactive.includes(e.label);e=!0}if(Gr(t,"labelPos"))for(let e of this.labelData)Gr(t.labelPos,e.label)?(e.x=t.labelPos[e.label][0],e.y=t.labelPos[e.label][1]):e.x=1;Gr(t,"projection")&&(this.proj=Array.from(t.projection.map((t=>Array.from(t))))),Gr(t,"selection")&&(null===t.selection?this.selection=null:this.selection=this.permutor.map((e=>t.selection[e])),this.selectionChanged=!0,n=!0),Gr(t,"filter")&&(null===t.filter?this.filter=null:this.filter=this.permutor.map((e=>t.filter[e]))),this.configure(),e&&this.emitChangeFilter(),n&&this.emitChangeSelectionIfNeeded()}}scheduleFrameIfNeeded(){!this.frameScheduled&&this.haveData&&(window.requestAnimationFrame(this.doFrame.bind(this)),this.frameScheduled=!0)}doFrame(t){if(this.frameScheduled=!1,!this.haveData)return;t/=1e3;let e=0;this.playing&&0!=this.lastTime&&(e=t-this.lastTime,this.fps.push(Math.round(1/e)),this.fps.length>100&&this.fps.shift()),this.lastTime=t,this.compute(e),this.configureScales();let n=null,r=null,i=this.labelData.filter((t=>t.selected));i.length&&("axis"==i[0].type?n=i[0].index:r=i[0].index);let a=this.getChecked("axesCheckbox"),o=Array(this.levels.length).fill(!0);for(let t of this.labelData)"level"==t.type&&(o[t.index]=t.active);let s=.05*this.size*Math.pow(10,this.getNumber("brushInput")),u=[];if(this.mouseX<this.size){for(let t=0;t<this.n;t++){if(!this.pointActive[t])continue;let e=Math.pow(this.xScaleClamped(this.xy[0][t])-this.mouseX,2)+Math.pow(this.yScaleClamped(this.xy[1][t])-this.mouseY,2);e>Math.pow(s,2)||u.push({index:t,d2:e})}u.sort(((t,e)=>t.d2-e.d2))}if(this.mouseDown||this.mouseWentDown){if(this.mouseWentDown&&!this.mouseShiftKey&&(this.selection=null,this.selectionChanged=!0),u.length){this.selection||(this.selection=Array(this.n).fill(!1),this.selectionChanged=!0);for(let t=0;t<u.length;t++)this.selection[u[t].index]||(this.selection[u[t].index]=!0,this.selectionChanged=!0)}this.mouseWentDown=!1}this.overlay.style.opacity=this.mousing?"1":"0";let l=window.devicePixelRatio;this.canvas.width=Math.floor(this.width*l),this.canvas.height=Math.floor(this.size*l);let c=this.canvas.getContext("2d");c.scale(l,l),c.clearRect(0,0,this.width,this.size);let f=this.xScale.range(),h=this.yScale.range();c.strokeStyle="#000",c.fillStyle="#fff",c.fillRect(f[0],h[0],f[1]-f[0],h[1]-h[0]),c.strokeRect(f[0],h[0],f[1]-f[0],h[1]-h[0]);let d=.75*this.zoom;if(c.strokeStyle="#ccc",a)for(let t=0;t<this.axes.length;t++){let e=Fr(this.proj[0],this.axes[t].unit),n=Fr(this.proj[1],this.axes[t].unit);c.beginPath(),c.moveTo(this.xScale(0),this.yScale(0)),c.lineTo(this.xScale(d*e),this.yScale(d*n)),c.stroke()}Lr(this.xy,this.proj,this.X);for(let t=0;t<this.lineFrom.length;t++){let e=this.lineFrom[t],n=this.lineTo[t];if(!this.pointActive[e]||!this.pointActive[n])continue;c.strokeStyle=!this.selection||this.selection[e]&&this.selection[n]?this.lineColors[t]:"#bbbbbb";let r=Math.sqrt(Math.pow(this.xy[0][e]-this.xy[0][n],2)+Math.pow(this.xy[1][e]-this.xy[1][n],2));r=Math.max(1/4,Math.min(1,r)),c.lineWidth=.25/r,c.beginPath(),c.moveTo(this.xScaleClamped(this.xy[0][e]),this.yScaleClamped(this.xy[1][e])),c.lineTo(this.xScaleClamped(this.xy[0][n]),this.yScaleClamped(this.xy[1][n])),c.stroke()}c.lineWidth=1;for(let t=0;t<this.n;t++)this.fillsFrame[t]=this.fills[t];if(this.selection)for(let t=0;t<this.n;t++)this.selection[t]||(this.fillsFrame[t]="#bbbbbb");if(null!==r&&o[r])for(let t=0;t<this.n;t++)this.group[t]!=i[0].index&&(this.fillsFrame[t]="#bbbbbb");if(null!==n)for(let t=0;t<this.n;t++){let e=this.axes[n].proj[t];e=Math.tanh(2*e),this.fillsFrame[t]=jr(.5*e+.5)}let p=this.pointSize;for(let t=0;t<this.n;t++)this.pointActive[t]&&(c.fillStyle=this.fillsFrame[t],c.fillRect(this.xScaleClamped(this.xy[0][t])-p,this.yScaleClamped(this.xy[1][t])-p,2*p,2*p));if(a&&null!==n){let t=Fr(this.proj[0],this.axes[n].unit),e=Fr(this.proj[1],this.axes[n].unit),r=[Fr(this.proj[1],this.axes[n].unit),-Fr(this.proj[0],this.axes[n].unit)];r=Rr(r,.03/Math.max(1e-30,Math.sqrt(Fr(r,r))));let i=new Map,a=this.size/this.zoom;for(let t=0;t<this.n;t++){if(!this.pointActive[t])continue;let e=this.axes[n].proj[t];i.set(Math.round(e*a)/a,this.fillsFrame[t])}for(let[n,a]of i){let i=[t*n,e*n],o=Br(i,r),s=Br(i,Rr(r,-1));c.strokeStyle=a,c.beginPath(),c.moveTo(this.xScaleClamped(o[0]),this.yScaleClamped(o[1])),c.lineTo(this.xScaleClamped(s[0]),this.yScaleClamped(s[1])),c.stroke()}}if(this.mousing&&u.length&&(c.fillStyle="#0000ff11",c.beginPath(),c.arc(this.mouseX,this.mouseY,s,0,2*Math.PI,!1),c.fill()),c.save(),c.textAlign="center",c.textBaseline="middle",c.lineJoin="round",c.lineWidth=5,a)for(let t=0;t<this.axes.length;t++){let e=Fr(this.proj[0],this.axes[t].unit),r=Fr(this.proj[1],this.axes[t].unit);if(this.axes[t].color)c.strokeStyle="#fff",c.fillStyle=this.axes[t].color;else{let i=e*e+r*r,a=t==n?"":Jr(2*i*355);c.strokeStyle="#ffffff"+a,c.fillStyle="#000000"+a}if(t===n){let n=Cr().domain([this.axes[t].center-this.axes[t].scale*d,this.axes[t].center+this.axes[t].scale*d]).range([-d,d]).ticks(5);c.font="12px sans-serif";for(let i of n){let n=(i-this.axes[t].center)/this.axes[t].scale;c.strokeText(`${i}`,this.xScale(n*e),this.yScale(n*r)),c.fillText(`${i}`,this.xScale(n*e),this.yScale(n*r))}}c.font="15px sans-serif",c.strokeText(this.axes[t].name,this.xScale(d*e),this.yScale(d*r)),c.fillText(this.axes[t].name,this.xScale(d*e),this.yScale(d*r))}if(this.mousing&&this.rownames.length){c.font="15px sans-serif",c.strokeStyle="#fff",c.fillStyle="#000";for(let t=Math.min(u.length,1)-1;t>=0;t--){let e=u[t].index,n=this.xScaleClamped(this.xy[0][e]),r=this.yScaleClamped(this.xy[1][e]);c.strokeText(this.rownames[e],n,r),c.fillText(this.rownames[e],n,r)}}if(c.restore(),c.textAlign="left",c.textBaseline="middle",c.font="15px sans-serif",!this.mousing)for(let t=0,e=0;t<this.levels.length;t++)o[t]&&(c.fillStyle=this.levelColors[t],c.fillText(this.levels[t],this.size+10,11+20*e),e++);let g="";this.mouseInCheckbox&&i.length?g=i[0].active?"click to hide\n":"click to show\n":null!==n||null!==r?g="drag to position\n":u.length&&!this.mouseDown?g=this.selection?"shift+click to enlarge\n":"click to select\n":this.selection&&this.mousing&&!u.length&&!this.mouseDown&&(g="click to clear\n"),this.get("messageArea").innerText=`${this.computeMessage||g}${Math.min(...this.fps)} to ${Math.max(...this.fps)} FPS`,this.playing&&(function(t){let e=t;for(;;){let t=window.getComputedStyle(e);if("0"===t.opacity||"none"===t.display||"visible"!==t.visibility)return!1;if(!e.parentElement)break;e=e.parentElement}let n=t.getBoundingClientRect();return n.top<window.innerHeight&&n.bottom>=0&&n.left<window.innerWidth&&n.right>=0}(this.container)?window.setTimeout(this.scheduleFrameIfNeeded.bind(this),5):(this.lastTime=0,window.setTimeout(this.scheduleFrameIfNeeded.bind(this),100))),this.selectionChanged&&!this.mouseDown&&this.emitChangeSelectionIfNeeded()}compute(t){let n=.1*Math.pow(10,this.getNumber("dampInput")),r=.1*Math.pow(10,this.getNumber("heatInput")),i=1*Math.pow(10,this.getNumber("guideInput")),a=1*Math.pow(10,this.getNumber("labelInput")),o=this.getChecked("heatCheckbox"),s=this.getString("guideSelect"),u=this.getChecked("labelCheckbox"),l=Array(this.levels.length).fill(!0);for(let t of this.labelData)"level"==t.type&&(l[t.index]=t.active);for(let t=0;t<this.n;t++)this.pointActive[t]=l[this.group[t]];if(null!==this.filter)for(let t=0;t<this.n;t++)this.pointActive[t]=this.pointActive[t]&&this.filter[t];this.dragging&&u&&(n=Math.max(n,5*a));let c=Math.max(1e-6,Math.min(1,t));this.computeMessage="";let f=this.vel,h=this.proj,d=Math.exp(-c*n);if(Yr(f,d),o){let t=1-d*d,e=zr(h.length,zr,this.m,ei.sample,0,Math.sqrt(r*t));e=Vr(e,h),Ur(f,e)}if("none"!=s){let t=this.X.filter(((t,e)=>this.pointActive[e]));if(t.length){let e=ti[s](h,t);Yr(e,-i),Ur(f,e)}}if(u)for(let t of this.labelData){let e=t.x,n=t.y;if(e<=-1||n<=-1||e>=1||n>=1)continue;if("level"==t.type&&!l[t.index])continue;let r=4*(e*e+n*n);f[0]=Br(f[0],Rr(t.vec,e*r*a)),f[1]=Br(f[1],Rr(t.vec,n*r*a))}let p=[];for(let t of this.labelData)"axis"!=t.type||t.active||p.push(this.axes[t.index].unit);let g=p.length>=this.m-1,m=!1;if(p.length&&!g){let t=Math.min(2,1/c),{u:n,v:r,q:i}=(0,e.SVD)(Wr(p)),a=Math.max(...i);n=Wr(n);let o=Or(2,this.m);for(let e=0;e<n.length;e++){if(i[e]<1e-6*a){m=!0;continue}let r=n[e];for(let e=0;e<2;e++)o[e]=Br(o[e],Rr(r,-Fr(r,f[e])-t*Fr(r,h[e])))}Ur(f,Vr(o,h))}g&&(this.computeMessage+="Error: too many axes removed\n"),m&&(this.computeMessage+="Note: redundant axes removed\n");let v=Xr(h,Hr(f,c)),{u:b,v:y,q:w}=(0,e.SVD)(Wr(v));Lr(v,y,b),this.vel=Hr(Xr(v,Hr(h,-1)),1/c),this.proj=v}}})(),langevitour=r})();
//# sourceMappingURL=langevitour-pack.js.map